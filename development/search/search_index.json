{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"USEF Flex Trading Protocol","text":""},{"location":"#usef-flex-trading-protocol","title":"USEF Flex Trading Protocol","text":"<p>The Universal Smart Energy Framework (USEF) has been developed to drive a fast, fair and lowest cost route to an integrated smart energy future. By delivering one common standard, it enables cost-efficient connectivity of all smart energy projects and technologies. Its market structure, roles, rules and tools for the commoditization and trading of flexible energy usage work with existing energy markets.</p> <p>The USEF Flex Trading protocol (UFTP) is a subset of the USEF framework. Focused specifically on the exchange of flexibility between Aggregators (AGRs) and DSOs, it describes the corresponding market interactions between them to resolve grid constraints by applying congestion management or grid-capacity management. UFTP can be used as a stand-alone protocol for flexibility forecasting, offering, ordering, and settlement processes.</p> <p>UFTP and the USEF Framework were originally developed, maintained and audited by the USEF Foundation. In 2021, USEF moved to the Linux Foundation Energy, and the project is rebranded as \u2018Shapeshifter \u2013 a universal flex trading protocol\u2019.</p>"},{"location":"#intellectual-property-disclaimer","title":"Intellectual property disclaimer","text":"<p>This specification is provided to you \"as is\" with no warranties whatsoever, including any warranty of merchantability, non-infringement, or fitness for any particular purpose. The authors of this specification disclaim all liability, including liability for infringement of any proprietary rights, relating to use or implementation of information in this specification. The provision of this specification to you does not provide you with any license, express or implied, by estoppel or otherwise, to any intellectual property rights.</p>"},{"location":"about/levels-of-compliancy/","title":"Levels of compliancy","text":""},{"location":"about/levels-of-compliancy/#levels-of-compliancy","title":"Levels of compliancy","text":"<p>UFTP has mandatory components and optional components. The tables below list all core and optional components. Support of core components is mandatory for all implementations. Optional components are signaled throughout the document. Optional components in messages are always prefixed with [optional].</p> Core UFTP components USEF 2015 UFTP Signaled in CRO? UFTP process: Day-ahead Flex trading o o - Redispatch responsibility choice - o Y Baseline choice - o Y Market messages: FlexRequest o o - FlexOffer o o - FlexOfferRevocation o o - FlexOrder o o - FlexSettlement o o - Optional UFTP components USEF 2015 UFTP Signaled in CRO? UFTP Process: Intraday Flex Trading o o N Availability contracts (FlexOptions) ~<sup>1</sup> o N Dynamic pooling - future ? Market messages: D-prognosis o o Y FlexReservationUpdate - o N FlexOffer: mutual exclusive offers - o Y FlexOffer: unsolicited offers - o - FlexOffer: partial activation - o - <ol> <li> <p>Availability contracts were mentioned in USEF2015, but not all details were worked out\u00a0\u21a9</p> </li> </ol>"},{"location":"about/purpose/","title":"Purpose","text":""},{"location":"about/purpose/#purpose","title":"Purpose","text":"<p>The USEF Flex Trading protocol (UFTP) is a subset of the USEF framework. Focused specifically on the exchange of flexibility between Aggregators (AGRs) and DSOs, it describes the corresponding market interactions between them to resolve grid constraints by applying congestion management or grid-capacity management. UFTP can be used as a stand-alone protocol for flexibility forecasting, offering, ordering, and settlement processes. Its purpose is to support the use of flexibility markets for grid-congestion issues and standardize the set-up and operation of these markets across different DSOs.</p>"},{"location":"about/reading-guideline/","title":"Reading guideline","text":""},{"location":"about/reading-guideline/#reading-guideline","title":"Reading guideline","text":"<p>The USEF Flexibility Trading Protocol Specification is accompanied by \u2018USEF: The Framework explained\u2019 <sup>1</sup> which provides insight into the background, scope and concepts underpinning USEF. It is strongly advised that the USEF document is read in advance of this UFTP specification document.</p> <p>USEF follows the principle of privacy &amp; security by design and therefore the specifications are accompanied by a privacy &amp; security guideline <sup>2</sup> which is applicable to the entire design, implementation and operation of USEF and derived products, services and solutions.</p> <p>The UFTP specifications consist of three main elements:</p> <ul> <li> <p>General description Informative description about usage of the protocol and process description for USEF\u2019s market-based coordination mechanism</p> </li> <li> <p>Use case descriptions Detailed descriptions of each process step of the process model, incl. scope &amp; level, goal in context, preconditions, primary and secondary actors, the main scenario, etc.</p> </li> <li> <p>Message transport &amp; descriptions Syntax descriptions of all the messages required for the interfaces described in the framework, as well as detailed requirements for exchanging those messages. A process description, including the specifications and rules that apply to each process, are provided. A motivation for the design is included, wherever it is assumed beneficial.</p> </li> </ul> <p>Recommended Practice:</p> <p>In order to make the universal descriptions of the framework applicable in practice and more comprehensible the specifications are accompanied by recommended practices. These paragraphs are clearly indicated, in blue, throughout the specifications.</p> <ol> <li> <p>USEF Foundation, \"USEF: The Framework Explained,\" USEF Foundation, Arnhem, 2015.\u00a0\u21a9</p> </li> <li> <p>USEF Foundation, \"USEF: The Privacy and Security Guideline,\" USEF Foundation, Arnhem, 2015. Available: https://www.usef.energy/app/uploads/2016/12/USEF_PrivacySecurityGuideline_3nov15.pdf \u21a9</p> </li> </ol>"},{"location":"about/scope/","title":"Scope","text":""},{"location":"about/scope/#scope","title":"Scope","text":""},{"location":"about/scope/#constraint-management-services","title":"Constraint management services","text":"<p>Constraint management services help grid operators (TSOs and DSOs) to optimize grid operation according to physical and market constraints. USEF <sup>1</sup> distinguishes four different flexibility services within the constraint management category: grid capacity management, congestion management, voltage control and controlled islanding. UFTP can be used for the first two of these.</p>"},{"location":"about/scope/#grid-capacity-management","title":"Grid capacity management","text":"<p>Grid capacity management refers to the use of explicit demand-side flexibility (by the DSO or TSO) to increase operational efficiency without impacting freedom of dispatch, trade and connect (copper plate principle). It is primarily used to defer grid reinforcements, optimize asset operational performance, reduce grid losses, or support planned maintenance. The implication is that AGRs (and prosumers) participate in the product on a voluntary basis; i. e. motivated by appropriate financial incentives.</p>"},{"location":"about/scope/#congestion-management","title":"Congestion management","text":"<p>Congestion management refers to the use of flexibility to reduce peak loads, in order to avoid system overload and the associated component or system failures. Contrary to grid capacity management, it will typically limit freedom of dispatch, trade and/or connect. It is primarily used in unanticipated overload situations; e. g. those which could not be forecast during long-term grid planning processes, or where load/ generation increases have outpaced grid reinforcement efforts. Congestion management is a temporary solution (typically until grid reinforcement takes place) and is a highly-regulated mechanism. At present, it is only available to TSOs in most European member states although it may be offered to DSOs in the future.</p> <p>The two mechanisms differ in the freedom of dispatch, trade and/or connect and this is handled via contracts and will have impact on the settlement components.</p>"},{"location":"about/scope/#bilateral-trading-and-trading-via-a-market-platform","title":"Bilateral trading and trading via a market platform","text":"<p>UFTP is designed for bilateral trading between the AGR and DSO. Trading via market platforms can bring added value, see <sup>2</sup>. In UFTP, market platforms may take the role of trading counterparty, hence serving as a DSO proxy in trades with the AGR, and as an AGR proxy in trades with the DSO. When trading via a platform, the role of FlexRequests from DSOs to AGRs is less obvious; i.e., a DSO has free choice of the available FlexOffers. In addition, FlexOffers and FlexRequests do not need to be directly related and so UFTP supports unsolicited FlexOffers without requiring a reference to an underlying FlexRequest.</p>"},{"location":"about/scope/#tsodso-coordination","title":"TSO/DSO coordination","text":"<p>USEF assumes that a DSO or TSO can freely and independently trade flexibility with AGRs. Any potential goal conflicts can be settled through the market mechanism. Alternatively, TSO and DSO requests can be aligned, resulting in a TSO/DSO coordination platform where TSOs and DSOs coordinate the tendering, trading, activation and/or settlement of flexibility for their own purposes ( i. e. ancillary services). See <sup>2</sup> for a discussion on this topic.</p> <p>UFTP can be applied without any further changes in a configuration where there is TSO/DSO coordination.</p>"},{"location":"about/scope/#alternative-use","title":"Alternative use","text":"<p>The text, graphs and examples in this document assume flex trading between AGR and DSO. However, UFTP can equally be used for grid constraint services between an AGR and TSO.</p> <p>The messages defined in UFTP can also be used for flexibility trading in the plan phase between an AGR and BRP. See the USEF Framework Specifications <sup>3</sup> for a complete description of this alternative use.</p> <ol> <li> <p>USEF, \"Flexibility Value Chain (update 2018),\" 8 10 2018. [Online]. Available: https://www.usef.energy/app/uploads/2018/11/USEF-White-paper-Flexibility-Value-Chain-2018-version-1.0_Oct18.pdf.\u00a0\u21a9</p> </li> <li> <p>USEF, \"White paper: Flexibility Platforms,\" 2 november 2018. [Online]. Available: https://www.usef.energy/app/uploads/2018/11/USEF-White-Paper-Flexibility-Platforms-version-1.0_Nov2018.pdf.\u00a0\u21a9\u21a9</p> </li> <li> <p>USEF, \"USEF - The FrameWork Specifications 2015,\" 2015. [Online].\u00a0\u21a9</p> </li> </ol>"},{"location":"appendix/bibliography/","title":"Bibliography","text":""},{"location":"appendix/bibliography/#bibliography","title":"Bibliography","text":"<ol> <li>USEF, \"Flexibility Value Chain (update 2018),\" 8 10 2018. [Online]. Available: https://www.usef.energy/app/uploads/2018/11/USEF-White-paper-Flexibility-Value-Chain-2018-version-1.0_Oct18.pdf.</li> <li>USEF, \"White paper: Flexibility Platforms,\" 2 november 2018. [Online]. Available: https://www.usef.energy/app/uploads/2018/11/USEF-White-Paper-Flexibility-Platforms-version-1.0_Nov2018.pdf.</li> <li>USEF, \"USEF - The FrameWork Specifications 2015,\" 2015. [Online].</li> <li>USEF Foundation, \"USEF: The Framework Explained,\" USEF Foundation, Arnhem, 2015.</li> <li>USEF Foundation, \"USEF: The Privacy and Security Guideline,\" USEF Foundation, Arnhem, 2015. Available: https://www.usef.energy/app/uploads/2016/12/USEF_PrivacySecurityGuideline_3nov15.pdf</li> <li>USEF, \"Recommended practices and key considerations for a regulatory framework and market design on explicit Demand Response,\" 2017. [Online]. Available: https://www.usef.energy/app/uploads/2017/09/Recommended-practices-for-DR-market-design-2.pdf.</li> <li>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, \"\"Hypertext Transfer Protocol -- HTTP/1.1\", RFC 2616,\" 1999.</li> <li>Bakke, M., Hafner, J., Hufferd, J., Voruganti, K., and M. Krueger, \"\"Internet Small Computer Systems Interface (iSCSI) Naming and Discovery\", RFC 3721,\" 2004.</li> <li>Satran, J., Meth, K., Sapuntzakis, C., Chadalapaka, M., and E. Zeidner, \"\"Internet Small Computer Systems Interface (iSCSI)\", RFC 3720,\" 2004.</li> <li>USEF Design Team, \"Release Details USEF Specification 2014:I.I,\" USEF Foundation, Arnhem, 2014.</li> <li>S. e. a. Tierney, \"Pay-as-Bid vs. Uniform Pricing,\" Fortnightly Magazine, March 2008.</li> <li>Wikipedia, \"IEC 62056,\" 27 March 2014. [Online]. Available: http://en.wikipedia.org/wiki/IEC_62056. [Accessed 28 May 2014].</li> <li>P. v. Oirsouw, Netten voor distributie van electriciteit, Arnhem: Phase to Phase, 2012.</li> <li>P. Mockapetris, \"\"Domain names - concepts and facilities\", STD 13, RFC 1034,\" 1987.</li> </ol>"},{"location":"appendix/flex-reservation-mechanism/","title":"Flex reservation mechanism","text":""},{"location":"appendix/flex-reservation-mechanism/#flex-reservation-mechanism","title":"Flex reservation mechanism","text":"<p>As introduced in Bilateral contract: FlexOption, DSO\u2019s may want to contract a minimum amount of flexibility to be sure that it is available on request. The FlexOption (not part of UFTP) is a bilateral contract between DSO and AGR to reserve a specified amount of flexibility at a specific location (i.e. congestion point), for a specified time schedule and duration. In the day-ahead grid planning process, the DSO\u2019s forecast will indicate whether the contracted amount of flexibility is actually needed. If not, the flexibility can be used for other purposes. The DSO can send a FlexReservationUpdate message to signal the actual needs to the AGR. This appendix describes the purpose of this FlexReservationUpdate message and its impact on the contractual obligations and the actual FlexRequest that may follow in the validate phase.</p> <p> </p> Example flex reservation and FlexReservationUpdate, displayed in graphs <p>The figure above illustrates how ISPs 11 to 16 are part of a contract, where the AGR is required to reserve flexibility at ISPs 12 to 15 (downwards power only \u2013 for more information on direction and amount of power, see Section Power). The DSO was obliged to send a FlexReservationUpdate before each deadline, confirming the reserved power or partially releasing it. The power values from the updated reservation should always be equal to, or lower than, the (absolute) values from the original reservation but since the contract is out-of-scope for UFTP, the DSO and AGR should maintain their own agreements about this.</p> <p>After the FlexReservationUpdate, the AGR is obliged to keep the amount of flexibility available \u2013 even if no FlexRequest follows. After a FlexRequest is published, the AGR is obliged to produce a FlexOffer that meets the contract within the boundaries of the FlexRequest, where only the lowest reserved and requested power is valid for the contract. This is illustrated in the following figure:</p> <p> </p> Example FlexRequest and requirements of FlexOffer, displayed in graphs <p>For further information on the FlexRequest, see Flexibility trading between the AGR and DSO. Both the FlexReservationUpdate and the FlexRequest can only reduce the amount of power that the AGR is obliged to offer, as opposed to increase it. For ISP 12, the requested power exceeds the power that the AGR had to reserve in advance. The contract is therefore only valid for the lowest (absolute) power value, being -2. For ISP 14, the opposite is happening: the reserved power is not requested. Therefore, the AGR is not obliged to provide flexibility for ISP 14.</p> <p>For ISP 15 and 16, available space is given for the AGR to deviate in the opposite direction. For all ISPs that are included in the contract \u2013 even when the reservation is set to 0 \u2013 the AGR is obliged to conform to the restrictions given by the FlexRequest, including the bounds of available space. The AGR is also free to provide more power than agreed, as long as it contributes to the decrease in congestion. In this example, the resulting FlexOffer that complies to the contract must be as illustrated in the graph on the right in the figure above.</p>"},{"location":"appendix/glossary/","title":"Glossary","text":""},{"location":"appendix/glossary/#glossary","title":"Glossary","text":"A-plan Aggregator-plan, used as Aggregator\u2019s nomination AGR Aggregator. Role whose goal it is to maximize the value of flexibility, taking into account customer needs, economical optimization and grid capacity. BRP Balance Responsible Party C&amp;I Commercial &amp; Industry Common Reference Information about the Energy grid and the involved parties, which needs to be unambiguously available to all participating parties. Congestion Point Point in de grid where the grid capacity is not always sufficient to distribute the requested amount of energy CRO Common Reference Operator D-prognosis Prognosis regarding the Distribution of energy DNO Distribution Network Operator DSO Distribution System Operator E-program Energy Program \u2013 aggregated (daily) energy transactions of a BRP to be provided to the TSO FlexOffer Flexibility Offer, response to a Flexibility Request FlexOrder Flexibility Order, a response to a Flexibility Offer FlexRequest Flexibility Request Grid Network for the transport and distribution of energy ISP Imbalance Settlement Period MBMA Measure Before Measure After (baseline methodology) MCM Market-based Coordination Mechanism (USEF) MDC Meter Data Company P&amp;S Privacy &amp; Security Prosumer A consumer which is capable of producing energy as well Settlement Determining the energy production and consumption and used flexibility as preparation for the billing process. Supplier Has a contractual relationship with Prosumers to source, supply and invoice energy TSO Transmission System Operator UFTP USEF Flex Trading Protocol USEF Universal Smart Energy Framework"},{"location":"appendix/message-transport-mechanism/","title":"Message transport mechanism","text":""},{"location":"appendix/message-transport-mechanism/#message-transport-mechanism","title":"Message transport mechanism","text":"<p>When implementing the USEF best-practice message transfer mechanism, the procedures outlined in this section apply.</p>"},{"location":"appendix/message-transport-mechanism/#cryptographic-scheme-cs","title":"Cryptographic Scheme (CS)","text":"<p>The USEF privacy and security guidelines require all participants to be able to securely transmit and authenticate messages. For these purposes, a transport-independent cryptographic scheme is specified, identified as Cryptographic Scheme Type 1 (CS1): implementation is a recommended practice for all implementations<sup>1</sup>. Based on NaCl<sup>2</sup>, a public domain library with high-speed state-of-the-art security features and a purpose-built and straightforward programming interface<sup>3</sup>, this scheme requires participants to generate two public/private key pairs:</p> Purpose NaCl function Private key bits Public key bits Digital signatures crypto_sign_keypair 512 256 Authenticated message encryption crypto_box_keypair 256 256 <p>The resulting private keys must be securely stored using an operating system or language-supplied facility for that specific purpose (e.g. the Win32 Data Protection API, OS X Keychain service or JVM KeyStore). In addition to being stored locally, the public keys are exchanged with other USEF participants. For that purpose, the keys are joined together in a single 64-byte array (signature key followed by encryption key), Base-64 encoded and prefixed by the constant cs1 and a period (indicating that the version 1 cryptographic scheme is used). For example: <code>cs1.V4lZrkYHq8FzneXxUML+QEMXMul3tBm+gPGoVDIZBA92VoWTu8/kRu2Zx72XOm1i/qwwoSgXjqSAqSa43myCaQ==</code></p> <p>This public key string can be published in the DNS zone of the domain used in the associated entity address, or manually exchanged with other USEF participants. If DNS is used, implementation of DNSSEC is mandatory, as otherwise the key material would be completely untrusted. Implementations must use a DNSSEC validating resolver, which can either be built-in, or an external resolver on a fully trusted network.</p> <p>When signing an outgoing message using the private digital signature key and NaCl\u2019s <code>crypto_sign</code> function, the result is an opaque blob: the sealed message. Unsealing this message, using the corresponding public digital signature key and <code>crypto_sign_open</code>, performs signature verification and returns the message plaintext. Since this all happens in the same API call, it is not possible to accidentally process an unsigned or incorrectly signed message.</p>"},{"location":"appendix/message-transport-mechanism/#message-exchange-logic","title":"Message exchange logic","text":"<p>The entire message exchange, from the client\u2019s outgoing message queue to the server\u2019s incoming message queue, using HTTP-over-TLS transport and the default cryptographic scheme, is visualized in detail in the picture below.</p> <p> </p> End-to-end USEF message exchange. <p>Messages go through the following stages between retrieval from the client\u2019s outgoing message queue and delivery to the server\u2019s inbound message queue.</p> <p>To prevent transient Internet connectivity or participant configuration issues from inhibiting message exchange, a retry mechanism could be implemented. The timer value used for such a period should be at least one hour for routine messages. Note that, although message queue implementations may inform the sending process about delivery delays, only the final success or failure status is authoritative. When retrying failed requests, the implementation must implement an exponential back off mechanism to prevent undue load on the remote service.</p>"},{"location":"appendix/message-transport-mechanism/#service-discovery","title":"Service discovery","text":""},{"location":"appendix/message-transport-mechanism/#versioning","title":"Versioning","text":"<p>For versioning of the specification we use semantic versioning (see https://semver.org/). In short: MAJOR.MINOR.PATCH. Each new major version is incompatible with previous versions; New minor versions are backwards compatible with previous minor versions within the same major version.</p>"},{"location":"appendix/message-transport-mechanism/#supporting-multiple-versions-of-the-protocol","title":"Supporting multiple versions of the protocol","text":"<p>DSO\u2019s should be more flexible than AGR\u2019s, so DSO\u2019s will support multiple versions of the protocol, but only for a restricted time.</p> <p>Also, the CRO should support multiple versions.</p> <p>DSO's and CRO are expected to support at most the three latest versions.</p>"},{"location":"appendix/message-transport-mechanism/#version-coupled-to-url","title":"Version coupled to URL","text":"<p>Each major version should have a different url-path, so it is possible to route each incompatible protocol version to another service. This means that for minor changes and patches the url will remain the same. The convention for the url-path (by example) is as follows:</p> <p>version 2.0.0: /shapeshifter/api/v2/message</p> <p>version 2.1.0: /shapeshifter/api/v2/message</p> <p>version 3.0.1: /shapeshifter/api/v3/message</p>"},{"location":"appendix/message-transport-mechanism/#messages","title":"Messages","text":"<p>The metadata of each message contains the specification version. A rejection reason will be added to reject a message with an invalid version</p>"},{"location":"appendix/message-transport-mechanism/#service-discovery_1","title":"Service discovery","text":"<p>The purpose of the discovery stage is to discover the endpoint, public-key for signing and, optionally, the capabilities (e.g. supported Shapeshifter versions) of the other participants. The requirements for this stage rely heavily on agreements made between the participants that will be communicating with each other using the protocol.</p> <p>If service discovery fails due to inability to collect all required data within this timeout period, the delivery of the message fails. Such messages are removed from the outgoing queue and returned to the sending process, indicating a transport error.</p>"},{"location":"appendix/message-transport-mechanism/#single-authority","title":"Single authority","text":"<p>One possible implementation for service discovery is creating a single authority that administers all the relevant information, and provides this to participants. This approach could be seen as having a central address book, so all participants know where and how to send messages to each other. </p> <p>Activities on the energy market are most likely regulated by national oversight bodies. Such organizations are natural candidates for running such a service. Role-wise, this would be handled by the CRO, but in practice it might often be a DSO.</p>"},{"location":"appendix/message-transport-mechanism/#dns","title":"DNS","text":"<p>Another possible implementation for service discovery is DNS<sup>4</sup>.  Assuming the Internet domain name of the remote participant is example.com, the relevant DNS records are as follows:</p> _usef.example.com TXT record specifying the version of the USEF specification implemented by this participant, e.g. <code>2015</code> _role._usef.example.com TXT record containing up to two<sup>5</sup> space-separated Base-64 encoded public key strings for the specified role, where role is one of the values <code>AGR</code>, <code>CRO</code> or <code>DSO</code>. This data is only queried if (part of) the outgoing message needs to be encrypted _http._role._usef.example.com CNAME record indicating the HTTP endpoint receiving messages for the specified role.This label must not have any resource records of other types (with the exception of the mandatory DNSSEC-related records<sup>6</sup>) and the alias should resolve to an A or AAAA record<sup>7</sup>.On the endpoint host, the implementation must listen on the well-known IANA-assigned TCP port for HTTP-over-TLS, i.e. 443.The implementation may listen on port 80 as well, but only for purposes such as supporting the HTTP/2 connection upgrade mechanism and never for unencrypted message exchange."},{"location":"appendix/message-transport-mechanism/#transmission","title":"Transmission","text":"<p>Once a valid service endpoint is available, the message enters the transmission stage<sup>9</sup>. The implementation will now, for a reasonable amount of time (which is again at least one hour for routine messages, employing exponential back off), attempt to deliver the message to the remote participant.</p> <p>Messages are sent using a HTTP POST operation with the text/xml<sup>10</sup> content type, the UTF8 character set and content-length indication. The request URI depends on the USEF implementation level and host name listed in DNS by the recipient. For USEF 2019 and the host <code>example.com</code>, it will be https://example.com/USEF/2019/SignedMessage.</p> <p>Message content consists of a simple wrapper message, specified as SignedMessage in the USEF XML XSD, available for download from the public USEF web site<sup>12</sup> at https://usef.info/schema/2019and documented in section Message catalog. All usual protocol conventions should be followed during this stage. For example, when using HTTP version 1.1, redirects (responses with status code 3xx) should be honored in order to support load balancing. Any server errors (responses with status code 5xx), unknown response status codes,  and connection timeouts and resets should be considered temporary failures and delivery should be re-attempted later within the timeout period. Only client success or failure messages (responses with status code 200 or a non-ambiguous<sup>13</sup> 4xx status code, respectively) should be considered final. This is standard HTTP 1.1 behavior, as fully described in IETF RFC 2616 <sup>11</sup>.</p>"},{"location":"appendix/message-transport-mechanism/#error-handling","title":"Error handling","text":"<p>In the transmission stage, the guidelines for error handling are as follows:</p> <p>Until the point that the message has been successfully validated against the USEF XML schema, errors are communicated using transport protocol mechanisms, e.g. HTTP status codes. For the HTTP protocol, the following error conditions are common (note that, depending on the server and libraries used, some of these may be handled automatically):</p> Condition Status code Error type Missing Content-Length header 411 Length Required Permanent (E cannot be resolved without changes to the sending implementation) Invalid Content-Type header (not text/xml) or character set (default: utf-8) 400 Bad Request Permanent Originating IP address is sending messages at a rate exceeding receiver policy 429 Too Many Requests Temporary Body XML cannot be parsed or is not compliant with USEF XML schema 400 Bad Request Permanent Failed to look up the sender\u2019s public signature key in DNS 419 Authentication Timeout Temporary (message can be processed when DNS is corrected/replicated) Invalid signature (inner XML message cannot be unsealed, for example due to NaCl\u2019s crypto_sign_open function failing) 401 Unauthorized Permanent (since no authorization schemes that would allow the request to be resubmitted are available, unless private arrangements between sender and recipient exist) Unsealed body XML cannot be parsed or is not compliant with the USEF XML schema 400 Bad Request Permanent <p>Once a message has been determined to be valid USEF XML, errors are reported using a USEF XML response message with a successful transport disposition (e.g. HTTP status code 200 OK). Possible results in this stage are:</p> <p>As in the service discovery stage, messages for which transmission permanently fails are removed from the outgoing queue and returned to the sending process, indicating a transport error.</p>"},{"location":"appendix/message-transport-mechanism/#common-message-metadata","title":"Common Message Metadata","text":"<p>The USEF XML message obtained after successfully verifying the signature will have a root node corresponding to its message type, which must contain Metadata attributes common to all messages used by the implementation to process the message. The metadata attributes are defined in metadata attributes.</p>"},{"location":"appendix/message-transport-mechanism/#awaiting-reply","title":"Awaiting reply","text":"<p>If message transmission succeeds, the implementation starts waiting for a reply from the remote service. Although replies to some messages can be expected immediately, other USEF messages may only elicit a response several hours later. In any case, responses are always decoupled from requests and implementations should be strictly asynchronous, correlating requests and responses using their conversation identifier.</p> <p>Because of the asynchronous nature of message exchange, a process needs to be in place for handling messages that do not receive a (timely) reply. When preparing a new message, the implementation should specify the message class, as well as the time period within which a reply is expected. The following message classes are defined:</p> <p>Incoming replies are validated using the steps outlined in the transmission stage. Where a reply is rejected, the pending outgoing message remains in the awaiting reply stage until it expires, and any additional manual processing is completed. Messages for which, ultimately, no reply is received are returned to the sending process, indicating expiry.</p>"},{"location":"appendix/message-transport-mechanism/#service-process-message-error-handling","title":"Service process message error handling","text":"<p>Since the message exchange process is responsible for transparently handling most, if not all, transient error conditions, service processes have no need for routine error recovery. In fact, any transport errors reported to the service layer are of such a severe nature that they most likely cannot be corrected without implementation or configuration changes:</p> <ul> <li>Malformed messages</li> <li>Entity address or signing key misconfigurationsExpired message, despite following manual recovery procedures for non-routine messages (for routine messages, no recovery is required by design but logging may definitely be appropriate)</li> </ul> <p>The suggested error handling strategy for service processes is to mark the affected remote participant (i.e. not try to exchange any future messages with it) and to emit a diagnostic message indicating that manual intervention is required. After the issue is investigated and resolved, the configuration can be manually updated to re-enable the participant.</p>"},{"location":"appendix/message-transport-mechanism/#ea1-addressing-scheme","title":"EA1 addressing scheme","text":"<p>In USEF messages, there is often a requirement for a globally unique identity for certain entities. To meet this requirement, USEF defines the Entity Address (EA). Each EA consists of a prefix, indicating the addressing scheme, followed by the actual address. Currently, two addressing schemes are supported:</p> <ul> <li>The European Article Number (EAN), commonly used to uniquely identify connection points in the electricity network and therefore a natural identifier to do the same in USEF. An example of an EA using this scheme is: ean.871685900012636543</li> <li>The USEF type 1 entity address (EA1) is designed to allow participants to generate unique identifiers for themselves and entities managed by them, without relying on a central authority.</li> </ul> <p>The USEF type 1 EA is structured analogous to the iSCSI IQN. Paraphrasing IETF RFCs 3720 and 3271 <sup>14</sup>: the EA does not define any new naming authorities but uses Internet domain names to ensure global uniqueness. Furthermore, the EA is constructed to give an organizational naming authority the flexibility to further subdivide the responsibility for name creation to subordinate naming authorities.</p> <p>This makes the EA format slightly unwieldy but since bandwidth and storage space are not expected to be significant constraints in any USEF implementation, this is considered to be an acceptable tradeoff for not requiring a central authority. Syntactically, an EA is a variable-length, 7-bit printable ASCII text string containing up to 255 characters. For example:</p> <pre><code>ea1.2013-11.info.usef.test:001:002.090807002a&amp;b#\n    &lt;- naming authority -&gt; &lt; unique identifier &gt;\n</code></pre> <p>Mostly taken from IETF RFC 3720 <sup>15</sup>, below are the semantics of the various parts of this EA:</p> ea1 Constant, indicating this is a type 1 USEF entity address 2013-11 A date code, in yyyy-mm format.  This date must be a date during which the naming authority owned the domain name used in this format, and should be the first month in which the domain name was owned by this naming authority at 00:01 GMT of the first day of the month.  This date code uses the Gregorian calendar.  All four digits in the year must be present.  Both digits of the month must be present, with January == \"01\" and December == \"12\".  The dash must be included. info.usef.test The reversed domain name of the naming authority (person or organization) creating this entity address 001:002.090807002a&amp;b# A locally unique string, which may contain product types, serial numbers, host identifiers, or software keys (specifically: it may include colons to separate organization boundaries).  With the exception of the colon prefix, the owner of the domain name can assign everything after the reversed domain name as desired. It is the responsibility of the entity that is the naming authority to ensure that the names it assigns are worldwide unique. <ol> <li> <p>If this recommendation is not followed, a compatible implementation should be provided in order to achieve USEF compliance.\u00a0\u21a9</p> </li> <li> <p>Pronounced \u201csalt\u201d and available with extensive documentation from http://nacl.cr.yp.to/. Sodium, https://github.com/jedisct1/libsodium, is an extended NaCl derivative with Windows, OS X and Linux platform support and many available language bindings. Sodium is highly recommended for USEF-compliant implementations.\u00a0\u21a9</p> </li> <li> <p>Whereas typical cryptographic libraries require several steps to implement message encryption or signing, with each step opening the door for fatal programming mistakes, NaCl offers simple high-level functions which take care of everything, dramatically reducing the risk of inadvertent implementation errors.\u00a0\u21a9</p> </li> <li> <p>Each USEF participant is responsible for publishing its own endpoint and public key information in a self-managed DNS zone. To prevent man-in-the-middle interference with the published information, use of DNSSEC is mandatory for such zones.\u00a0\u21a9</p> </li> <li> <p>Usually one public key string will be present, but in order to support key rotation without invalidating in-transit messages, the implementation should list both the old and the new key for a short period of time (e.g. 24 hours) after a key has been replaced\u00a0\u21a9</p> </li> <li> <p>USEF participants must enable DNSSEC and implementations must use a validating resolver, treating verification failures as temporary errors, eligible for retrying later. Absent DNSSEC authentication, private key strings must not be relied on, and separate manual secure key exchange is required.\u00a0\u21a9</p> </li> <li> <p>As per IETF RFC 1034 <sup>8</sup>, implementations must not fail when presented with CNAME chains or loops. Chains should be followed (to an implementation-defined maximum depth) and any loops or errors treated as temporary.\u00a0\u21a9</p> </li> <li> <p>P. Mockapetris, \"\"Domain names - concepts and facilities\", STD 13, RFC 1034,\" 1987.\u00a0\u21a9</p> </li> <li> <p>For messages containing non-public information, this stage transition may also include encryption of message sections using the public encryption key of the remote participant.\u00a0\u21a9</p> </li> <li> <p>The USEF specification uses XML, since this format is already widely used in the rather conservative energy market, and enjoys wide and mature tooling support (particularly in the area of schema authoring and validation). Unlike other XML-based initiatives (such as WS-*), lightweight implementations are considered key, and alternate serialization formats (such as JSON) should be viable as well, despite being out of scope of this specification. If any such alternate message formats are implemented, fallback to XML must be provided as needed, or such implementations will not be USEF-compliant.\u00a0\u21a9</p> </li> <li> <p>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, \"\"Hypertext Transfer Protocol -- HTTP/1.1\", RFC 2616,\" 1999.\u00a0\u21a9</p> </li> <li> <p>Please note that USEF makes no warranties whatsoever as to the uninterrupted availability of its web site, and that production services should not rely on the schema being hosted at this location for purposes such as validation: a local copy should be used instead.\u00a0\u21a9</p> </li> <li> <p>The prime example of an ambiguous HTTP status code is 404 Not Found: since this is commonly returned by front-end servers in case of temporary back-end issues, USEF implementations are encouraged to consider this a temporary error.:\u00a0\u21a9</p> </li> <li> <p>Bakke, M., Hafner, J., Hufferd, J., Voruganti, K., and M. Krueger, \"\"Internet Small Computer Systems Interface (iSCSI) Naming and Discovery\", RFC 3721,\" 2004.\u00a0\u21a9</p> </li> <li> <p>Satran, J., Meth, K., Sapuntzakis, C., Chadalapaka, M., and E. Zeidner, \"\"Internet Small Computer Systems Interface (iSCSI)\", RFC 3720,\" 2004.\u00a0\u21a9</p> </li> </ol>"},{"location":"appendix/rationale-for-information-exchange-in-flexibility-request/","title":"Rationale for information exchange in flexiblity request","text":""},{"location":"appendix/rationale-for-information-exchange-in-flexibility-request/#rationale-for-information-exchange-in-flexibility-request","title":"Rationale for information exchange in flexibility request","text":"<p>USEF specifies that when sending a flexibility request, the DSO provides the following information about expected congestion. This appendix provides the rationale.</p> <ul> <li> <p>Information about expected congestion is provided to all registered AGRs: The reduction required must be made available to all AGRs operating in the specific congestion area, due to the DSO\u2019s legal obligation to treat all market parties in a non-discriminatory way. The grid topology, however, is considered to be confidential information. Therefore, USEF recommends that information about expected congestion is not provided freely to the entire market at national level.</p> </li> <li> <p>Information about expected congestion includes the direction of the overload (production/consumption): A grid overload at a congestion point can occur as a result of either too much production or too much consumption. To reduce overload where there is too much production, either the production must be reduced, or the consumption must be increased. For overload where there is too much consumption, this is the other way around (increase production or decrease consumption). The implication is that the congestion information provided must be clear about the direction of the overload.</p> </li> <li> <p>Information about expected congestion includes the volume of reduction required. While it is sufficient for the DSO to provide only information about the need for reduction, rather than the volume of reduction required for an ISP, it makes sense to provide more detailed information as this is likely to result in a more optimal use of flexibility and therefore better usage of the grid.</p> </li> <li> <p>Information about expected congestion includes available grid capacity for other ISPs. Providing insight on the available grid capacity for the ISPs without congestion gives AGRs additional information that can be used to determine their flexibility offers. In addition, it reduces the likelihood that the load shift provided by the AGRs will create a new peak that overloads the grid, and thus is likely to converge quicker, making the time needed to align a D-prognosis shorter. Whether or not this time is needed mainly depends on the number of congestion points a DSO has defined. On the downside, the more information provided by the DSO, the easier it is to get insight into the entire grid topology, especially for crucial points in the grid.</p> </li> </ul>"},{"location":"assets/images/","title":"Index","text":""},{"location":"assets/images/#images","title":"Images","text":"<p>This folder contains images used in the documentation.</p>"},{"location":"assets/images/#emf-files","title":"EMF files","text":"<p>Many images originate from the original USEF specification created in Microsoft Word. During the migration to Markdown based documentation these images have been exported to EMF (Enhanced Windows Metafile) files. To convert these images to open standards, they have been opened in LibreOffice Draw and saved as ODG files, as well as being exported to SVG files. Although SVG files work well for the web-based documentation, some show up with wrong fonts and black elements in the PDF export. Therefore the SVG files have been exported to rendered PNG files for final use.</p>"},{"location":"assets/images/#rendering-png-files","title":"Rendering PNG files","text":"<p>The PNG files have been generated from the SVG files using Inkscape on the Bash commandline:</p> <pre><code># for IMG in $(ls *.svg); do inkscape ${IMG} -o ${IMG}.png --export-dpi=150; done\n</code></pre>"},{"location":"general-description/","title":"Index","text":""},{"location":"general-description/#general-description","title":"General description","text":"<p>This chapter describes the global information flows for flexibility trading between AGR and DSO for grid contraint purposes. In this respect, UFTP acts as a subset of USEF\u2019s market-based coordination mechanism (MCM), where AGR-DSO trading is an embedded part of the broader mechanism which applies to multiple flexibility services for all relevant market roles. In order to understand how UFTP is embedded in USEF, we have used some of USEF\u2019s general concepts to describe the UFTP processes. For further information on these, please see \u2018USEF: The Framework explained\u2019 <sup>1</sup>. Sections describe the interactions in the different Phases of MCM: Contract, Plan, Validate, Operate and Settle.</p> <ol> <li> <p>USEF, \"Flexibility Value Chain (update 2018),\" 8 10 2018. [Online]. Available: https://www.usef.energy/app/uploads/2018/11/USEF-White-paper-Flexibility-Value-Chain-2018-version-1.0_Oct18.pdf.\u00a0\u21a9</p> </li> </ol>"},{"location":"general-description/contract-phase/","title":"Contract phase","text":""},{"location":"general-description/contract-phase/#contract-phase","title":"Contract phase","text":""},{"location":"general-description/contract-phase/#overall-description","title":"Overall description","text":"<p>The contract phase is when DSOs and AGRs begin interaction. Typically, this involves a pre-qualification process, where the AGRs capability to deliver flexibility, portfolio and IT systems are assessed. AGR pre-qualification is out-of-scope for UFTP and therefore not further described in this document. See <sup>1</sup> for more information. In addition, the contract phase includes the exchange of information related to congestion points and associated connections through the common reference. Note that any contract negotiations for bilateral contracts also takes place in the contract phase (see below).</p> <p> </p> General information flow in the Contract phase <p>As part of its internal grid planning process, a DSO determines where congestion may possibly take place. Congestion points are declared whenever necessary, most likely several times a year, depending on the volume of trend analyses performed by a DSO and the condition of the grid. By publishing a particular congestion point, the DSO opens a flexibility market for it. AGRs publish the customers that they serve in the common reference. As a result, a DSO can determine whether there is liquidity on its market and AGRs know which of their customers can participate in a DSO\u2019s market.</p> <p>USEF introduces two alternative options for the DSO to procure flexibility from AGRs:</p> <ul> <li> <p>Long-term flexibility options: activation of flexibility options in prearranged bilateral contracts. Contracts of this nature oblige the AGR to offer a fixed amount of flexibility to the market via daily FlexOffers. This product guarantees a certain regular availability of flexibility but the price (model) has to be arranged in advance. As a result, the DSO can select the contract(s) that provide the required flexibility at the lowest costs although these, typically, will not reflect all flexibility available in the market or the actual marginal costs for any flexibility supplied. This method is comparable to the way in which national TSOs contract balancing services and a tender or auction procedure can be implemented to manage it, alongside long-term flexibility options subject to prearranged specific conditions; e.g. which include a maximum or fixed price for the activation of the flexibility.</p> </li> <li> <p>Short-term flexibility options: procuring flexibility that AGRs have offered for a specific day. In this situation, the AGR has no contractual obligation to offer the flexibility to the market but decides to do so on a day-to-day basis. This product inherently deals with short-term flexibility which is only valid for a specific day. The price offered by AGRs will better reflect the marginal costs although the availability of the flexibility in this product is not guaranteed. This method is comparable with the way market parties are free to offer capacity to the TSO on the secondary and tertiary markets (regulating and reserve power) on a daily basis.</p> </li> </ul> <p>The first option seems attractive for the DSO as it guarantees a minimum supply of flexibility, therefore reducing availability risks in the validate phase, but this comes at a higher price. The DSO is responsible for finding the right balance between costs and certainty, while ensuring that grid reliability is always maintained. It is important to note that both products are part of the same flexibility market and therefore it provides natural growth options for the evolution of flexibility trading. While, initially, the availability of flexibility supply and demand might be a primary concern for both buyers and sellers, leading them to focus on long-term contracts, this will likely change as the market matures and availability becomes less of an issue. At that point, both buyers and sellers would be willing to have greater reliance on short-term flexibility which, in turn, would offer increased market liquidity.</p>"},{"location":"general-description/contract-phase/#bilateral-contract-flexoption","title":"Bilateral contract: FlexOption","text":"<p>For long-term flexibility, USEF introduces the FlexOption. This type of contract enables the DSO to take an option on future flexibility. In relation to this, USEF specifies that:</p> <ul> <li>a FlexOption is a bilateral contract between DSO and AGR to deliver a specified amount of flexibility, at a specific location (i.e. congestion point), for a specified time schedule and duration.</li> <li>FlexOptions force the AGR to send flexibility offers when the flexibility requests match the contract details.</li> <li>FlexOptions are tradable via secondary markets.</li> </ul> <p>Recommended practice:</p> <p>In order to make FlexOptions attractive to AGRs, a DSO could add remuneration components; e.g. availability remuneration and/or a minimum number of activations.</p> <p>A FlexOption contract typically has the following ingredients:</p> Element Description Example(s) ISPs and durations The Imbalance Settlement Period (ISP) in which the flexibility should be delivered and the duration of the contract. <ul><li>Every ISP between 17:00 and 19:00 on Fridays</li><li>from December through March for the coming two years</li></ul> Lead time Time before the (recurring) flexibility option expires. <ul><li>One week before dispatch</li><li>The day before dispatch at 16:00</li><li>Does not expire</li></ul> Congestion Point DSO-specific: Congestion Point at which the flexibility should be realized. Amount Amount of flexibility being offered, specified as a delta to a baseline value or drop to mechanism. <ul><li>10kW (average power per ISP)</li></ul> Capacity remuneration Price the AGR receives for offering the flexibility option <ul><li>\u20ac20/MW/day</li><li>\u20ac40/MW/ISP</li></ul> Volume remuneration Maximum or predefined price for the flexibility, to be paid when the flexibility is ordered by the DSO. <ul><li>\u20ac20/MWh</li><li>Less than \u20ac20/MWh</li><li>\u20ac0</li></ul> Maximum number of activations The Maximum number of activations at which the flexibility in the LT contract can be called upon. <ul><li>Once per contract</li><li>Once per month</li><li>Unlimited</li></ul> Recovery Time Minimum time between activiations Penalties Amount the AGR is penalized for not offering the option of flexibility and/or the flexibility itself. n/a <p>UFTP does not include messages to communicate the contents of a FlexOption; this is assumed to be out-of-scope.</p>"},{"location":"general-description/contract-phase/#common-reference","title":"Common Reference","text":"<p>A DSO declares its congestion points in the contract phase. An AGR must be able to retrieve information about these points since this allows it to fulfil its obligation to provide the compulsory D-prognoses to DSOs for congestion points at which it represents customers. It also aids the AGRs portfolio optimization activities.</p> <p>Since a prosumer can switch AGRs, and the congestion points in the grid change over time, USEF introduces a \u2018common reference\u2019. The common reference contains a list of connection identifiers (for example EANs) for each congestion point, as registered by the participating DSOs. Each AGR also registers the connections on which it represents prosumers. The common reference is shared between all involved parties, while respecting privacy and security principles <sup>2</sup> which ensures, amongst other things, that only necessary information is shared and therefore included in the common reference. The common reference is operated by the Common Reference Operator (CRO) role. Conceptually, it contains the entities and relationships shown in the figure below:</p> <p> </p> Logical structure of the Common Reference <p>The common reference is, typically, setup by the DSO and includes all of its congestion points. However, it could be extended to form a common reference at national or European grid level.</p> <p>UFTP allows for the registering and tracking of changes in the common reference; e.g. a DSO might announce a new congestion point for the following week which is registered in the common reference. The history of all changes to the common reference is retained and can be retrieved for a certain date using the query function functions (see AGRPortfolioQuery and DSOPortfolioUpdate); this will also help resolve any potential disputes.</p>"},{"location":"general-description/contract-phase/#accessibility-of-the-data-in-the-common-reference","title":"Accessibility of the data in the common reference","text":"<p>Access to the common reference data is limited according to the legal or contractual requirements of the various parties consulting it<sup>3</sup>. This implies that a DSO can only see the data for the connections it is responsible for. Consequently, it can see which AGRs are serving its connections, in order to ensure that it receives D-prognoses from them.</p> <p>AGRs can only see information about the congestion points for which they serve connections. In addition, they can retrieve the number of connections per congestion point. Implementing the common reference this way ensures that the DSO does not need to share details of its grid topology.</p> <p>The common reference can be operated in two modes: open mode and closed mode. If operating in open mode, the CRO will accept updates from any USEF-compliant participants. In closed mode, participants will need to be pre-configured in order for updates to be accepted.</p> <ol> <li> <p>USEF, \"Recommended practices and key considerations for a regulatory framework and market design on explicit Demand Response,\" 2017. [Online]. Available: https://www.usef.energy/app/uploads/2017/09/Recommended-practices-for-DR-market-design-2.pdf.\u00a0\u21a9</p> </li> <li> <p>USEF Foundation, \"USEF: The Privacy and Security Guideline,\" USEF Foundation, Arnhem, 2015. Available: https://www.usef.energy/app/uploads/2016/12/USEF_PrivacySecurityGuideline_3nov15.pdf \u21a9</p> </li> <li> <p>Another option is to treat the common reference as open data, therefore implying that everyone can access it. Although the open data model can ease the implementation of the common reference, the acceptance of such a model by prosumers is highly dependent on the culture in the geographical area in which the model is used.\u00a0\u21a9</p> </li> </ol>"},{"location":"general-description/operate-phase/","title":"Operate phase","text":""},{"location":"general-description/operate-phase/#operate-phase","title":"Operate phase","text":"<p>While (similar to the current liberalized energy market) the total energy system will remain in balance, without any congestion issues, as long as there are no deviations from the plans, it is unlikely that all plans will be executed exactly. Deviations can arise from a range of sources, ranging from changing weather expectations to an extension of a football match. Deviations can lead to: imbalances in supply and demand of energy at total system level (affecting the BRP); changes within the AGR portfolio (affecting the AGR); and local congestion in the distribution system (affecting the DSO). USEF\u2019s MCM is designed such that, during the operate phase, additional flexibility can be applied in order to compensate for these deviations. The processes for invoking this flexibility are depicted in the following figure.</p> <p> </p> General information flows in the Operate phase. <p>During the operate phase, the AGR\u2019s main goal is to adhere to its plan and respect the D-prognoses.<sup>1</sup> In order to achieve this, FlexOfferRevocation the AGR must first plan to ensure assets operate in accordance with its forecast portfolio performance and that any flexibility sold is actually delivered.</p> <p>Next, the AGR measures the net demand or supply of its portfolio, in order to detect deviations from its plan and D-prognoses. Where deviations occur, the AGR re-optimizes its portfolio. It is possible that deviations could be solved using the flexibility contained within the portfolio itself.</p> <p>If this is not the case, the AGR must change its plan (and probably limit its liabilities due to non-performance, to minimize fines) and control the assets to ensure that the new plans are realized and send an updated D-prognosis. If a FlexOffer has already been ordered, but the AGR is not able to comply, the AGR should inform the DSO as soon as possible through direct means outside of the UFTP protocol. During the operate phase, the AGR may wish to revoke outstanding (i.e. not ordered) FlexOffers if it is no longer able or willing to deliver the flexibility.</p> <p>Although the DSO will reduce congestion risks in the validate phase, the DSO can still request that AGRs dispatch flexible power options to resolve potential grid problems in the operate phase. Again, due to time constraints, this will be done based on flexibility offers from the validate phase, which are still valid. When this flexibility is used, the corresponding BRP portfolio will no longer be in balance. Where the AGR is responsible for the balance, it will most likely charge the additional costs to the DSO. This is not considered further.</p> <ol> <li> <p>UFTP allows for alternative baselines, see General description. In case of alternative baselines, D-prognosis is optional.\u00a0\u21a9</p> </li> </ol>"},{"location":"general-description/plan-phase/","title":"Plan phase","text":""},{"location":"general-description/plan-phase/#plan-phase","title":"Plan phase","text":"<p>USEF\u2019s plan phase aims to find an economically optimized program to supply the energy demand of both AGR and BRP portfolios for a certain period. In this phase, the AGR optimizes its portfolio and typically arbitrages between different flexibility markets to maximize the value of the available flexibility. The result of this process is a balanced portfolio. The exchange between AGR and BRP\u2019s and corresponding trades on the energy markets are out-of-scope for UFTP. The result, however, will lead to a D-prognosis in the validate phase.</p> <p>The processes that take place during the plan phase are schematically depicted in the following figure.</p> <p> </p> General information flow in the Plan phase <p>Since the list of connections belonging to a congestion point, and the list of customers that are served by the AGR, may switch from day to day, USEF specifies that this information is requested on a day-to-day basis.</p> <p>The AGRs portfolio optimization is out-of-scope and depicted only for reference. See <sup>1</sup> for a detailed description of this process. For UFTP, it is important to realize that the AGR optimizes its portfolio based on its clients\u2019 needs, optionally taking into account its long-term contractual obligations.</p> <p>For bilateral contracts, the DSO might provide a FlexReservationUpdate message e.g. signaling which part of the contracted volume is still reserved and which part is not needed and may be used for other purposes. This will typically re-trigger the AGRs portfolio optimization process. More information about the flex reservation mechanism is added in Rationale for information exchange in flexibility request.</p> <ol> <li> <p>USEF, \"USEF - The FrameWork Specifications 2015,\" 2015. [Online].\u00a0\u21a9</p> </li> </ol>"},{"location":"general-description/settle-phase/","title":"Settle phase","text":""},{"location":"general-description/settle-phase/#settle-phase","title":"Settle phase","text":""},{"location":"general-description/settle-phase/#overall-description","title":"Overall description","text":"<p>In the settle phase, the AGR is remunerated for the delivered flexibility. There should be a check first, to ensure that the procured flexibility was actually delivered. A penalty may be applied when there is a mismatch between the baseline and the actual profile. Except for metering data, USEF assumes that both AGR and DSO have all the information to make these calculations. The DSO sends its calculation to the AGR for verification.</p> <p> </p> General information flow flex settlement between DSO and AGR <p>In order to perform the settlement, it is necessary for the DSO to compare the metering for each ISP against the baseline, as contained in the demand-prognosis message. In some regions the metering for the ISP periods for the fiscal meter may already be available to the DSO, through its own systems. However, where the DSO does not have access to the meter data, or where plant metering is used for settlement assessment, the metering data must be communicated to the DSO by the AGR. For this purpose the AGR will use the Metering messages to send the daily metering per ISP from each connection point.</p> <p>Recommended Practice: It is recommended to the include the Power profile in the settlement messages.</p> <p>Each month, the DSO will calculate the flexibility settlement volumes and prices for each AGR according to the steps below.</p> <ol> <li>Calculate procured flexibility For each congestion point and ISP, both the volumes and prices of the acquired flexibility are collected.</li> <li>Gather Metering Data This is done either based on the DSO\u2019s own metering records or using the metering message</li> <li>Validate if baselines are met This step is only performed where flexibility has been procured from the specific AGR, for a congestion point and ISP. The deviation between the final forecast (taking into account all procured flexibility) and the realized profile is calculated.</li> <li>Calculate flex settlement volumes and prices The settlement volumes and prices are calculated (see example below).</li> <li>Send settlement message to AGR This shows, per month, the accumulated settlement volume, accumulated deviation from the agreed baselines, and accumulated settlement price (accumulated over the ISPs and the congestion points).</li> </ol> <p>The AGR will use its own information to do the same calculations</p> <ol> <li>Calculate sold flexibility (equivalent to 1)</li> <li>Validate if baselines are met (equivalent to 2)</li> <li>Plausibility check (equivalent to 3) The results are compared to the settlement message received from the DSO.</li> </ol> <p>If the difference in the previous plausibility check is within limits, the AGR sends an acknowledgement to the DSO. If the difference exceeds predefined limits, the DSO\u2019s calculation is disputed. This is signaled via the SettlementResponseMessage. The dispute process is not part of USEF.</p>"},{"location":"general-description/settle-phase/#settlement-details","title":"Settlement details","text":"<p>The DSO is responsible for settling the flexibility that it has acquired from the AGR. Within this settlement, the DSO needs to check whether the acquired flexibility has been delivered according to the agreements. Penalties can arise where agreements have not been met and this is considered an integral part of the settlement process.</p> <p>This section describes how the supply of flexibility from the AGR to the DSO is settled. Several methods are possible, depending on how the flexibility is offered to the DSO and, more precisely, whether the DSO uses the mechanism of long-term and short- term flex options, and whether these flex options are rewarded, even if they are not exercised. Passive contribution to constraint management may also be rewarded.</p> <p>Calculations are (in general) performed at ISP level, with settlement calculated over a one-month period.</p>"},{"location":"general-description/settle-phase/#settlement-components","title":"Settlement components","text":"<p>The settlement consists of five components:</p> <ol> <li>Settlement of acquired flexibility The DSO will acquire flexibility through the market mechanism if congestion is expected, either ahead of time (validate phase) or real-time (operate phase). On average, the market price is determined by the equilibrium of demanded and offered flexibility (merit order). Following the recommendation given in Section Flexibility trading between the AGR and DSO, pay-as-bid pricing is used for individual settlements.</li> <li>Settlement of deviations from baselines AGRs that have sold flexibility to the DSO need to limit their capacity to the value stated in the baseline, corrected for the sold flexibility. A penalty is raised for each ISP where the agreed capacity has (on average) been exceeded. The penalty is single sided, meaning that the AGR is allowed to deviate from its baseline as long as the deviation contributes to avoiding the grid constraint.</li> <li>[optional] Settlement of long-term flexibility options (bilateral contracts) The DSO may acquire long-term flexibility options to ensure that congestion can be avoided at all times. This may be necessary to justify a decision to delay or defer grid investments, or where grid constraints are expected in the (near) future. The DSO will determine (e.g. through audits) that the AGR is always capable of providing the contracted flexibility (at contracted times).</li> <li>[optional] Settlement of short-term flexibility options (FlexOffers which are not procured) When grid constraints are expected during the validate phase by the DSO, all AGRs are asked to place flexibility offers. AGRs whose flexibility bids are accepted by the DSO are expected to meet their (adjusted) baselines. However, it is just as important for the DSO that the other AGRs are also bound to their baselines. To enforce and reward this, the DSO may also accept an option on the flexibility offered by the AGR, even if the bid is not accepted, to ensure the AGR will not jeopardize grid constraints by invoking its flexibility for other purposes. The DSO will pay the AGR for the option, as this will put a constraint on the total capacity of the AGRs portfolio.</li> <li>[Optional] Settlement of passive contribution to constraint management Possible reward for AGRs that passively support the management of grid constraints \u2013 either by staying below the agreed value expressed in their baselines or by reducing more power than agreed in the exercised flexibility bid. This is specifically relevant if constraints have been resolved by passive contributions, where other AGRs have exceeded the agreed capacities. In this situation, the passive contribution can be rewarded using the raised penalties (zero sum calculations).</li> </ol> <p>The settlement method implicitly assumes that each AGR has the motivation and capacity to produce high quality baselines.</p>"},{"location":"general-description/settle-phase/#settlement-calculations","title":"Settlement calculations","text":"<p>(numbers refer to the settlement components above)</p> Nr. Amount P = Q = Remark(s) 1 P x Q P = flexiblity fee Q = power called (\"Delivered Flex Quantity\") The flexibility fee is determined by the equilibrium of demanded and offered flexibility (flexibility market). 2 P x Q P = excess penalty (asymmetrical, only applied when deviation has contributed to congestion) Q = allocation \u2013 initial baseline \u2013 \u03a3 FlexOrders (\"Power Deficiency Quantity\"), where allocation is the average realized power during the ISP This penalty only applies to AGRs that have sold flexibility (for this ISP), and corresponds with not meeting the agreements of the flexibility bid. 3 negotiated n.a. n.a. The DSO will pay compensation for the long-term flexibility contract in proportion to the agreed power, the duration of the time slot, the nomination lead-time and the duration of the contract. Fixed fee may be derived from:<ul><li>The costs for allowing thermal limitations to be violated;</li><li>The avoided costs for grid reinforcements;</li><li>The value of flexibility for alternative uses;</li><li>The costs of alternative flexibility options.</li></ul> 4 P x Q P = flexibility option fee Q = power option In this settlement component, an AGR can be rewarded for participating in the flexibility market through short-term products. Rationale for relating the flexibility option settlement to the capacity offered is that an option to cap the capacity of an AGR with twice the capacity of another AGR, has twice the value to the DSO. 5 P x Q P = contribution fee (asymmetrical, only applied when deviation has relieved congestion). Derived from excess penalties raised. Q = allocation - baselines \u2013 power flexibility called during Operate phase where allocation is the average realized power during the ISP."},{"location":"general-description/settle-phase/#settlement-example","title":"Settlement example","text":"<p>For a specific ISP we assume:</p> <ul> <li>The AGR has specified a total load of 10 MW in its initial baseline</li> <li>During one or more flexibility requests, a total of 2 MW of flexibility has been acquired by the DSO, yielding an adjusted baseline of 8 MW</li> <li>The table below shows how different realizations are settled. The realization is specified by the allocation, representing the average power during one specific ISP for one congestion point. In this example the following (illustrative) prices are applied:<ul> <li>Flex price equals 7 \u20ac / MW</li> <li>Baseline deviation penalty equals 11 \u20ac / MW (single sided)</li> </ul> </li> </ul> Allocation (MW) Flex realized (MW) Delivered flex quantity (MW) Flex paid (\u20ac) baseline deviation (MW) Power deficiency quantity (MW) Penalty raised (\u20ac) Settlement (\u20ac) 7 3 2 14 -1 0 0 14 8 2 2 14 0 0 0 14 9 1 1 7 1 1 -11 -4 10 0 0 0 2 2 -22 -22 11 -1 0 0 3 3 -33 -33 <p>Elaboration of the calculations performed in the table:</p> <ol> <li>Allocation shows possible results of the realization of the AGR portfolio</li> <li>The flex realized equals the baseline associated with the flex offer minus the allocation</li> <li>The delivered flex quantity, represents the flexibility that is both acquired (therefore maximum of 2) and delivered. Passive contributions (as in the row with allocation=7) are not rewarded.</li> <li>The flex paid equals the delivered flex quantity times the flex price</li> <li>The baseline deviation equals the allocation minus the adjusted baseline</li> <li>The power deficiency quantity equals the baseline deviation, where negative deviations are set to 0 since these are not penalized.</li> <li>The penalty raised equals the power deficiency quantity times the penalty</li> <li>The settlement price equals the sum of the flex paid and penalties raised.</li> <li>The monthly totals of the elements: delivered flex quantity, power deficiency quantity and Settlement are sent to the AGR.</li> </ol>"},{"location":"general-description/usef-general-concepts/","title":"USEF general concepts","text":""},{"location":"general-description/usef-general-concepts/#usef-general-concepts","title":"USEF general concepts","text":""},{"location":"general-description/usef-general-concepts/#usef-market-based-coordination-mechanism-mcm","title":"USEF market-based coordination mechanism (MCM)","text":"<p>USEF\u2019s MCM facilitates the delivery of value propositions (i.e. marketable services) to various market parties without imposing limitations on the diversity and customization of the propositions. The USEF MCM is designed for all energy commodities and enables the market to optimize in time, capacity and power. The MCM provides access, under equal conditions, for all stakeholders to a single integrated market. This unique approach aims to deliver a future-proof market design. The USEF MCM operations scheme distinguishes five phases:</p> <p></p> <p>In UFTP, the general MCM phases are followed. However, processes in each phase are limited to the interactions between the AGR and DSO for flexibility trading. This includes interaction with the \u2018Common Reference\u2019:</p> <ul> <li> <p>Contract: AGR and DSO negotiate FlexOptions. This is flexibility that is reserved for DSO purposes and can be invoked by the DSO when needed. Typically, a contract includes availability remunerations and activation remunerations.</p> </li> <li> <p>Plan: information exchange between DSO and AGRs related to congestion points. This information exchange through the \u2018Common Reference\u2019 involves communication with the Common Reference Operator (CRO). The AGR carries out an initial portfolio optimization.</p> </li> <li> <p>Validate: the DSO uses D-prognoses to validate whether the demand and supply of energy can be distributed safely without any limitations. If congestion occurs, the DSO can procure flexibility from AGRs to resolve grid capacity issues.</p> </li> <li> <p>Operate: in the operate phase, the actual assets and appliances are dispatched and the AGR adheres to its D-prognoses. When required, DSOs can invoke additional flexibility from AGRs to resolve unexpected congestion.</p> </li> <li> <p>Settle: in the settle phase, the flexibility that the AGR has sold to DSOs is settled. For this purpose, the actual consumed and produced volumes are allocated to the responsible parties first. Any unresolved or disputed volumes are reconciled shortly afterwards.</p> </li> </ul>"},{"location":"general-description/usef-general-concepts/#usef-operating-regimes","title":"USEF Operating regimes","text":"<p>USEF recognizes four different operating regimes. The green regime is the classical grid without any limitations (copper plate) and the red regime is where power outages occur. USEF introduces two additional regimes. In the green and yellow regimes, the MCM assures optimal use of the flexibility available for BRPs (green and yellow) and DSOs (yellow). The orange regime is introduced as a fallback for situations where there is insufficient flexibility available for the DSO to avoid an outage\u2014the DSO can limit connections to temporarily overrule the market.</p> <p> </p> USEF Operating regimes <p>UFTP flexibility trading takes place solely in the yellow regime. Full descriptions of all other regimes can be found in <sup>1</sup>.</p>"},{"location":"general-description/usef-general-concepts/#day-head-and-intraday-flexiblity-trading","title":"Day-head and intraday flexiblity trading","text":"<p>The plan and validate phases aim to make optimal use of flexibility and maximize the freedom of dispatch and transactions of all stakeholders before the actual delivery of energy takes place. The timescale of these phases already ranges from years and months ahead, towards one day ahead and, ultimately, hours ahead before the actual delivery of energy (i.e. the operate phase) starts. This broad time window supports trading on various energy markets (i.e. forward market, day-ahead spot market and intraday spot-market) and the monitoring of changes in the required grid capacity.</p> <p>USEF specifies that iterations between the plan and validate phases take place at least twice: initially, during the day ahead and, secondly, during intraday. Hence, two points in time are determined when the markets close: 1) end of day-ahead 2) end of intraday. This specification eases the iterative process of creating, aligning and converging plans and D-prognoses and fits well with many current national processes applied in the day ahead and intraday trading market. Please find more details in Iterations between the plan and validate phases.</p> <p>UFTP supports both day-ahead and intraday trading. Intraday trading is optional for UFTP.</p>"},{"location":"general-description/usef-general-concepts/#congestions-points","title":"Congestions points","text":"<p>A congestion point is a set of connections which (directly) relate to a part of the grid where grid capacity might be exceeded because it may be insufficient to distribute the requested amount of energy; e.g. the secondary side of an LV transformer. Please note that a congestion point is a part of the grid where congestion may possibly occur, rather than actually occurs. It is the DSOs responsibility to determine congestion points.</p> <p>Recommended practice:</p> <p>How to determine which grid points are congestion points is the DSOs responsibility and therefore outside of the scope of USEF. However, USEF recommends declaring congestion points at the lowest possible level in the grid as this allows for detailed insight about local congestion while simultaneously, through aggregation, safeguarding the reliability of the grid safety analysis.</p> <p>Congestion points are registered in the common reference, see Common Reference.</p>"},{"location":"general-description/usef-general-concepts/#flexiblity-market-time-granularity","title":"Flexiblity market time granularity","text":"<p>All flexibility exchange in USEF is based on a time granularity that is in line with the imbalance settlement period (ISP)<sup>2</sup>, which is the time unit for which the imbalance of the balance responsible parties is calculated. For most EU countries this is a 15-minute interval, leading to 96 ISPs per day. Forecasts, flexibility offers, and orders and settlement are all based on ISPs. Flexibility is expressed in Power [Watts] which is to be interpreted as the average Power during an ISP.</p>"},{"location":"general-description/usef-general-concepts/#alternative-baselines","title":"Alternative baselines","text":"<p>All flexibility trading in USEF assumes that flexibility offers take the form of deviation from baseline, i.e. the default situation that would occur if no flexibility were activated. Typically, the baseline is derived via an AGR nomination referred to as the D-prognosis. However, UFTP allows for alternative baseline, where a D-prognosis is not required, and it is assumed that the AGR and DSO agree upon the baseline. An alternative baseline could be based on a measurement (MBMA-method), a mathematical formula or a reference group, etc. The choice of the alternative baseline and its establishment is out-of-scope for UFTP. The UFTP trading messages either refer to D-prognosis or to an external baseline reference. Throughout this document, the D-prognosis is used as the default baseline method. If UFTP is used with alternative baseline, then all references to the D-prognosis can be ignored.</p> <ol> <li> <p>USEF, \"USEF - The FrameWork Specifications 2015,\" 2015. [Online].\u00a0\u21a9</p> </li> <li> <p>Commission Regulation (EU) 2017/2195 of 23 November 2017 establishing a guideline on electricity balancing defines an imbalance settlement period (ISP) as the time unit for which the imbalance of the balance responsible parties is calculated (Article 2(10)).\u00a0\u21a9</p> </li> </ol>"},{"location":"general-description/validate-phase/","title":"Validate phase","text":""},{"location":"general-description/validate-phase/#validate-phase","title":"Validate phase","text":""},{"location":"general-description/validate-phase/#overall-description","title":"Overall description","text":"General information flow in Validate phase <p>Assuming that D-prognoses are used as baseline<sup>1</sup>, each AGR creates a D-prognosis per declared congestion point and sends it to the DSO. Sending D-prognoses is not required when an alternative baseline method has been agreed. When all D-prognoses for a congestion point are received, the DSO combines these with the forecasts of non-AGR connections to execute a final grid safety analysis. This analysis determines whether it is possible to distribute the planned energy, or the limits of the distribution grid are reached. In the latter situation, USEF moves to the yellow regime and the DSO procures flexibility in the market to resolve these congestion issues. The process of flexibility trading is as follows:</p> <ol> <li>The DSO requests all AGRs at the congestion point to provide flexibility. In this request, the DSO indicates the magnitude (amount of excess power) and timing (ISP) of the expected congestion, and how much capacity is available in the remaining ISPs. This is handled via a FlexRequest.</li> <li>AGRs who are able and willing to change their load/generation profile in line with the request create FlexOffers.</li> <li>If the offers are a good fit; i.e. help to mitigate congestion, the DSO can procure flexibility by placing a FlexOrder.</li> <li>AGRs send an updated D-prognosis which incorporates the flexibility ordered.</li> </ol> <p>If the flexibility offered is not sufficient to resolve the expected congestion, or no flexibility is offered, USEF moves to the orange regime. Please note that in this situation, USEF specifies that the DSO procures all offered flexibility from the market (i.e. from the yellow regime) to solve parts of the congestion. This is because any flexibility offered will still help to reduce the impact of the orange regime (e.g. the number of connections impacted by the graceful degradation). USEF\u2019s orange regime is outside the scope of UFTP, and, therefore, not further discussed in this document.</p> <p> </p> AGR may send multiple FlexOffers on the same request, and open FlexOffers, which are not yet ordered may be revoked by the AGR. <p>AGRs may respond with one or more FlexOffers. Where an AGR responds with multiple FlexOffers, the DSO can freely choose the most appropriate offer(s). Provided the flexibility has not been ordered via a FlexOrder, a FlexOffer may be revoked by the AGR (FlexOfferRevocation).</p> <p> </p> Flexibility trading may go on until gate closure time. This includes iterations between plan phase and validate phase. The last accepted D-prognosis before gate closure time serves as a basis for the next phase. Any open FlexOffers, which are not expired, may be ordered after gate closure."},{"location":"general-description/validate-phase/#exchange-of-d-prognoses-between-agr-and-dso","title":"Exchange of D-prognoses between AGR and DSO","text":"<p>When using D-prognoses as the baseline methodology, an AGR sends its D-prognosis per congestion point to the DSO. The DSO assesses the validity of each received D-prognosis and informs the AGR whether or not it is accepted. As long as the gate closure time has not passed, the AGR can update its D-prognoses and resend it to the DSO. During these iterations, an accepted D-prognosis<sup>2</sup> is assumed actual, provided no associated updates are received and accepted by the DSO.</p> <p>For the exchange of D-Prognoses, USEF specifies the following:</p> <ul> <li>An AGR is obliged to create a D-prognosis for its connections as soon as its connection point is declared by a DSO. The AGR is informed of this congestion point via the mandatory (daily) CRO queries.</li> <li>The D-prognosis only includes the forecasted load of those prosumers served by the AGR and that have a connection related to a congestion point.</li> <li>The D-Prognosis contains one full calendar day for the day-ahead process. In the intraday process, all remaining ISPs for that calendar day must be included</li> <li>The average power is given per ISP as a minimum time granularity</li> <li>The D-Prognosis does not include additional information; e.g. details about the available flexibility or prices</li> </ul> <p>USEF provides the following recommended practices for the exchange of D-Prognoses:</p> <ul> <li>The D-Prognosis is sent day-ahead to the DSO; at the latest, two hours before the gate closure of the national balancing regime (day-ahead gate closure)<sup>3</sup></li> <li>The DSO can perform a monthly evaluation of the accuracy and reliability of D-prognoses in order to motivate AGRs to improve the D-prognoses they supply</li> </ul>"},{"location":"general-description/validate-phase/#processing-d-prognoses","title":"Processing D-prognoses","text":"<p>When all D-prognoses relating to a particular congestion point are received, the DSO creates a total prognosis for each congestion point. When accumulating the D-prognoses, the DSO must estimate and add the distribution requirements required for those connections which are not served by an AGR, and, therefore, not included in the D-prognoses. Using the accumulated D-prognosis, the DSO can determine whether it is possible to distribute the planned energy, or whether the limits of the distribution grid will be reached.</p> <p>The timing of the FlexRequest is determined by the DSO, who must make a trade-off between waiting for all AGRs to send their D-prognoses<sup>4</sup> before identifying grid constraints or issuing a FlexRequest based on its own grid forecasting process. It is the DSO\u2019s responsibility to combine the two sources of information. Where alternative baseline methods are used, the DSO will issue a FlexRequest based solely on its own information.</p> <p>The grid safety analysis can lead to either of the following conclusions:</p> <ul> <li>That no congestion is expected. All power flows are within calculated safety margins.</li> <li>That congestion is expected as the energy flows exceed calculated safety margins. The DSO then starts the process of acquiring flexibility from the market.</li> </ul> <p>Where no AGRs are active at the congestion point, there is no market to supply the DSO with flexibility to reduce its energy flows to levels below the safety margins. In this situation, the system moves to the orange regime. The resulting DSO processes are outside the scope of this document. See <sup>5</sup> for a global description.</p>"},{"location":"general-description/validate-phase/#flexibility-trading-between-the-agr-and-dso","title":"Flexibility trading between the AGR and DSO","text":"<p>If the outcome of the grid safety analysis is that congestion will arise, the system is moved to the yellow regime and the DSO will need to take action. In order to solve the expected congestion, the following steps are taken:</p> <ol> <li>The DSO requests all AGRs at the congestion point to provide flexibility. In its request, the DSO indicates the magnitude (amount of excess power) and timing (ISP) of the expected congestion and (optionally) how much capacity is available in the remaining ISPs</li> <li>The AGRs receive the flexibility request for adjusting<sup>6</sup> distribution requirements</li> <li>AGRs generate offers for the flexibility. Note that these offers could either be the result of a voluntary offering process or compulsory, where there are prearranged bilateral contracts between DSO and AGR (FlexOptions)</li> <li>The DSO receives the flexibility offers</li> <li>The DSO procures flexibility to resolve the congestion issues by placing flexibility orders.</li> <li>The DSO determines whether the expected congestion is solved using the ordered flexibility. If this is not the case, the system moves to the orange regime (see <sup>5</sup> for more details)</li> <li>The AGRs receive the flexibility orders which result in the actual procurement of flexibility by the DSO.</li> <li>AGRs provide an (updated) D-prognosis, incorporating the ordered flexibility. This step only applies when D-prognoses are used as baseline methodology.</li> </ol> <p>When trading via a market platform AGRs typically offer their flexibility without an underlying request (unsolicited flex offers) and the DSO selects appropriate offers. Steps 1 and 2 are not applicable in this situation.</p> <ul> <li>Information about expected congestion is provided to all registered AGRs;</li> <li>Expected congestion information includes the direction of the overload (production/consumption);</li> <li>Expected congestion information includes the amount of reduction needed;</li> <li>Expected congestion information includes available grid capacity for other ISPs.</li> </ul> <p>See Rationale for information exchange in flexibility request for more details about this information exchange including rationale.</p> <p>In the FlexRequest messages, there is no single power value, rather a power space for each ISP, bound by two power values (\u201cMinPower\u201d and \u201cMaxPower\u201d). In addition, there is a distinction between ISPs with a \u2018requested\u2019 disposition \u2013 meaning that there is a request for a deviation on the power consumption/production \u2013 and ISPs with an \u2018available\u2019 disposition \u2013 meaning that there is available space to deviate on the power consumption/production.</p> <p> </p> Example forecast for a Congestion point, leading to an example FlexRequest, both displayed in graphs <p>In the example used in the figure above, congestion is expected at ISP 2 at a certain congestion point. The FlexRequest is transmitted to all AGRs that have prosumers on the congestion point, requesting a decrease of consumption (or an increase of production) on ISP 2. If AGRs choose to shift consumption from ISP 2 to another ISP, the available spaces in the ISPs from the FlexRequest indicate that there is more room for consumption in ISP 5 than in ISP 1, 3 and 4. A flexibility offer with a consumption shift to ISP 5 is therefore more likely to be ordered.</p> <p>Note that a request is always relative to the agreed baseline. The essence of broadcasting the same request to all AGRs is that the requested deviation is the same for each AGR, relative to its own baseline. Decreasing power consumption is thereby equivalent to increasing power production and vice versa.</p> <p>The distribution of the FlexRequest message is limited to AGRs which are registered via the CRO (see Plan phase). The information on direction, amount and available capacity is provided in specific data structures that are part of the FlexRequest message (see Power).</p> <p>For the procurement of flexibility by the DSOs, USEF specifies the following rules:</p> <ul> <li>A flexibility offer is valid until it expires or is revoked. It is the AGRs responsibility to determine the acceptance deadline. Revocation is not possible after the offer has been ordered.</li> <li>A flexibility order is definite and binding once it has been placed.</li> <li>The DSO chooses which flexibility offers it accepts to solve the congestion. In this regard, it is not obligatory for the DSO to start with the offer that has the lowest price. The DSO has the freedom to assess the balance between the price and quality<sup>7</sup> of the flexibility offered in both long-term contracts and short-term offers.</li> <li>Bidding takes place at congestion point level, making every congestion point a local flexibility market.</li> <li>The DSO sends a flexibility request when the result of the grid safety analysis indicates possible congestion.</li> <li>A flexibility order is linked to a flexibility offer and a baseline for settlement purposes.</li> </ul> <p>UFTP has two optional structures in the trading messages:</p> <ul> <li> <p>[optional] A FlexOffer can contain multiple mutually exclusive options. The DSO is able to pick one of the options in its FlexOrder. Whether or not an AGR is allowed to add multiple options is signaled in the CRO.</p> </li> <li> <p>[optional] AGRs may indicate the capability for partial activation in their offers. In all messages, a minimum activation percentage is provided i.e. all values lower than 100% mean that partial activation is possible. The DSO could use partial activation to better match the requested flexibility with available offers. Partial activation applies to all ISPs in the offer and also to the offered price. For example, if the DSO procures 80% of the offer, all ISPs in the FlexOrder should be 80% of the corresponding ISPs in the FlexOffer, and the settlement price is set to 80% of the original price in the offer. If the DSO has not implemented the option, it may simply ignore the structure.</p> </li> </ul>"},{"location":"general-description/validate-phase/#updates-after-flex-has-been-ordered","title":"Updates after flex has been ordered","text":"<p>USEF specifies that when ISPs are altered as a result of a flexibility deal, the resulting load for these ISPs is used for settlement. This means that deviation on ISPs with \u2018requested\u2019 disposition that have been traded, might lead to penalties for the associated AGR. Updates on other ISPs are always possible for the AGR but will require a new D-prognosis. Other AGRs can still change their D-prognoses for all ISPs without incurring a penalty. More details about the penalty calculation can be found in the settlement.</p> <p>The load profile resulting from a flexibility deal will be stored independently from any subsequent updates of the D-prognosis, because it allows the DSO to verify the actual delivery of the flexibility for settlement purposes.</p> <p>Recommended Practice for flexibility trading:</p> <p>For the procurement of flexibility by the DSOs, USEF recommends the following:</p> <ul> <li>Publishing is in an anonymized way</li> <li>Pay-as-bid is used for pay-out.</li> <li>Timing of the flexibility orders is between 24 and 2 hours before delivery (day-ahead trading).</li> </ul>"},{"location":"general-description/validate-phase/#iterations-between-the-plan-and-validate-phases","title":"Iterations between the plan and validate phases","text":"<p>As a result of flexibility exchange with the DSO, the AGRs portfolio is not balanced and so it may wish to re-optimize it. By doing so, the MCM returns to the plan phase, the only difference being that the AGR now takes the flexibility it has already sold into account. In addition, during the plan phase, the AGR has the freedom to continuously re-optimize its portfolio whenever deemed necessary (e.g. when new and improved forecasts are available). The rationale behind this high degree of freedom for the AGRs is to ensure that the flexibility they offer is applied in the most optimal and cost-effective way (i.e. flexibility is used there where it creates most value).</p> <p>However, these iterative processes also lead to the issue that D-prognoses change continuously, and continuous alignment is required between AGR/DSO. As a result, there is a risk that the iterative process between the plan and validate phases does not converge. In conclusion, there is a balance to be struck between making sure that the iterative processes converge, and offering a high degree of freedom to ensure that the available flexibility is used in the most optimal and cost-effective way.</p>"},{"location":"general-description/validate-phase/#gate-closure-times","title":"Gate closure times","text":"<p>For reasons mentioned above, USEF specifies that there needs to be at least two moments in time when the iterations are forced to end. This moment is called the gate closure time.</p> <p>In alignment with the current practices in liberalized energy markets, the two gate closure times are:</p> <ol> <li> <p>Day-ahead closure time: the moment at which the day-ahead market closes. During the day-ahead period, the plan and validate phases can be iterated as often as needed, as long as the system converges before the gate closure time. After the day-ahead closure time, the processes in the plan phase can only be restarted during the intraday period.</p> </li> <li> <p>Intraday closure time<sup>8</sup>: the moment at which the intraday market closes. During the intraday period, the plan and validate phases can be iterated as often as needed, as long as the system converges before the gate closure time. After the intraday closure time, the processes in the plan phase cannot be restarted at all, as the MCM moves to the operate phase.</p> </li> </ol> <p> </p> Example of USEF day-ahead gate closure time. <p>An example of the day-ahead gate closure is given in the figure above. Please note that while there is a single day-ahead gate closure time per day, there will be multiple intra-day gate closures. This is illustrated in the figure below. The ISP corresponding to the current time is in operate phase and ISP\u2019s more than one hour ahead are still in plan or validate phase.</p> <p> </p> Example of USEF intra-day gate closure times. <p>Recommended Practice:</p> <p>The national regulator determines the specific timing details of the gate closures. USEF recommends:</p> <ul> <li>A day-ahead gate closure time of 2 hours before the gate closure of the national balancing market</li> <li>An intraday gate closure time of one hour before the start of the ISP</li> </ul>"},{"location":"general-description/validate-phase/#balance-responsibility-and-redispatch-options","title":"Balance responsibility and redispatch options","text":"<p>The procurement of flexibility by the DSO may impact the AGRs balance position (nomination)<sup>9</sup>. Therefore, USEF\u2019s validate phase is iterative with the plan phase, i.e. the AGR can make adjustments to its nomination via energy exchange with its associated BRP and/or energy trades on the energy markets. When the gate closure time is reached, all issues need to be resolved or there will be in an imbalance in the AGRs portfolio (which is the AGRs responsibility).</p> <p>As an alternative, the procurement of flexibility is organized as an energy trade between AGR and DSO. In this situation, the AGR portfolio stays balanced and there is no need to iterate to the plan phase. Nevertheless, the AGR is free to re-optimize its portfolio at any time, for any reason, which could induce iterations. The DSO faces imbalance as a result of the trade and is responsible for this. The DSO\u2019s imbalance can be restored via a counter trade outside the congested area (redispatch).</p> <p>USEF supports both ways of balance responsibility. The DSO determines the method of trading for a given congestion point and signals this via the CRO. See DSOPortfolioUpdate.</p> <p>Recommended practices for balance responsibility:</p> <ul> <li>USEF recommends that the AGR retains balance responsibility for day-ahead flexibility trading. Any imbalance risk as a result of DSO trades can be mitigated via day-ahead energy trades.</li> <li>USEF recommends shifting the balance responsibility to the DSO for intraday flexibility trading. This is equivalent to an energy trade from AGR to DSO. In order to neutralize its position, the DSO should then trigger a counter-trade (redispatch).</li> </ul> <ol> <li> <p>UFTP allows for alternative baselines, see General description. In case of alternative baselines, D-prognosis is optional.\u00a0\u21a9</p> </li> <li> <p>The accepted D-prognosis is the D-prognosis that used as a basis for the next period (Intraday) or phase (operate).\u00a0\u21a9</p> </li> <li> <p>For the difference between day-ahead and intraday, please refer to Iterations between the plan and validate phases \u21a9</p> </li> <li> <p>USEF 2015 specified that the DSO should wait for all D-prognoses to be submitted. This would allow for a more precise determination of possible congestion and also ensure a fair process of offering and procuring flexibility. However, this constraint hinders the process in situations where there are missing or late D-prognoses.\u00a0\u21a9</p> </li> <li> <p>USEF Foundation, \"USEF: The Framework Explained,\" USEF Foundation, Arnhem, 2015.\u00a0\u21a9\u21a9</p> </li> <li> <p>Either by decreasing energy use, increasing local generation, or time-shifting load.\u00a0\u21a9</p> </li> <li> <p>For example, it is desirable for the DSO to procure flexibility that moves energy use from a moment in time of high load to a moment in time of very low load, rather than procuring flexibility that moves energy use from a moment in of high load to a moment in time at which the maximum of the distribution capacity is almost reached.\u00a0\u21a9</p> </li> <li> <p>Note that intraday flexibility trading is optional in UFTP so intraday gate closure applies only when intraday trading is enabled by the DSO\u00a0\u21a9</p> </li> <li> <p>his is not the case when the AGR can manage the deviation itself, e.g. one prosumer uses more energy, another prosumer uses less energy, and these two level each other out.\u00a0\u21a9</p> </li> </ol>"},{"location":"message-descriptions/scope/","title":"Scope","text":""},{"location":"message-descriptions/scope/#scope","title":"Scope","text":"<p>USEF defines the content of XML messages between role processes, as required for implementation of USEF\u2019s MCM. Each message has a unique recipient, identified by the Internet domain and USEF role of the participant. The message transfer mechanism is responsible for sending and receiving these messages.</p> <p> </p> Relationship between the normative USEF XML messages (yellow pane) and the best-practice message transfer mechanism (light-blue pane). <p>When selecting a message transfer mechanism, local market conditions should be considered and the USEF privacy and security guidelines should be followed <sup>1</sup>. Further recommendations about the message transport mechanism are given in Message transport mechanism.</p> <ol> <li> <p>USEF Foundation, \"USEF: The Privacy and Security Guideline,\" USEF Foundation, Arnhem, 2015. Available: https://www.usef.energy/app/uploads/2016/12/USEF_PrivacySecurityGuideline_3nov15.pdf \u21a9</p> </li> </ol>"},{"location":"message-descriptions/message-catalog/","title":"Index","text":""},{"location":"message-descriptions/message-catalog/#message-catalog","title":"Message catalog","text":"<p>USEF messages consist of XML, use UTF-8 encoding, and should validate against the USEF schema corresponding to the specification version implemented by a participant. The current version of this schema, as well as historic production versions are available for download from the Shapeshifter Github. Message types can be differentiated using the name of their root node.</p> <p>To allow extensibility as well as forward and backward compatibility of XML messages, the USEF schema allows additional elements in each defined sequence, as long as these elements have an explicit, non-default XML namespace.</p>"},{"location":"message-descriptions/message-catalog/agr-portfolio-query-response/","title":"AGRPortfolioQueryResponse","text":""},{"location":"message-descriptions/message-catalog/agr-portfolio-query-response/#agrportfolioqueryresponse","title":"AGRPortfolioQueryResponse","text":"<p>Upon receiving and processing an AGRPortfolioQuery message, the receiving implementation must reply with an AGRPortfolioUpdate, indicating whether the query was handled successfully.</p> <pre><code>&lt;AGRPortfolioQueryResponse\n  Metadata\u2026\n  ReferenceMessageID         = UUID\n  Result                     = (\"Accepted\" | \"Rejected\")\n  RejectionReason            = String (only if Result = \"Rejected\")\n  Period                     = Date\n  &lt;DSO-View                    (only if Result = \"Accepted\")\n    &lt;DSO-Portfolio             (0...n)\n      DSO-Domain             = InternetDomain\n      &lt;CongestionPoint         (1...n)\n        EntityAddress        = EntityAddress\n        MutexOffersSupported = Boolean\n        DayAheadRedispatchBy = (\"AGR\" | \"DSO\" )\n        IntradayRedispatchBy = (\"AGR\" | \"DSO\" ) (optional)\n        &lt;Connection          = (1...n)\n          EntityAddress      = EntityAddress\n        /&gt;\n      /&gt;\n      &lt;Connection            = (0...n)\n        EntityAddress        = EntityAddress\n        /&gt;\n      /&gt;\n    /&gt;\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see section metadata attributes. ReferenceMessageID MessageID of the AGRPortfolioQuery message Result Indication whether the AGRPortfolioQuery was accepted or rejected. RejectionReason In case the AGRPortfolioQuery was rejected, this attribute must contain a human-readable description of the reason. Period The Period that the portfolio is valid. DSO-View \u21e5 DSO-Portfolio Portfolio of a single DSO that shares connections with the AGR \u21e5 \u21e5 DSO-Domain The InternetDomain of the DSO the portfolio applied to. \u21e5 \u21e5 CongestionPoint A CongestionPoint that contains at least one Connection of a prosumer that is represented by the AGR. \u21e5 \u21e5 \u21e5 EntityAddress Entity Address of the CongestionPoint entity being updated. \u21e5 \u21e5 \u21e5 MutexOffersSupported Indicates whether the DSO accepts mutual exclusive FlexOffers on this CongestionPoint \u21e5 \u21e5 \u21e5 DayAheadRedispatchBy Indicates which party is responsible for day-ahead redispatch, AGR or DSO. \u21e5 \u21e5 \u21e5 IntradayRedispatchBy Indicates which party is responsible for intraday ahead redispatch, AGR or DSO. If not specified, there will be no intraday trading on this CongestionPoint. \u21e5 \u21e5 \u21e5 Connection \u21e5 \u21e5 \u21e5 \u21e5 EntityAddress Entity Address of a Connection that is part of this CongestionPoint. \u21e5 \u21e5 Connection Connection not belonging to any DSO CongestionPoint \u21e5 \u21e5 \u21e5 EntityAddress Entity Address of the Connection"},{"location":"message-descriptions/message-catalog/agr-portfolio-query/","title":"AGRPortfolioQuery","text":""},{"location":"message-descriptions/message-catalog/agr-portfolio-query/#agrportfolioquery","title":"AGRPortfolioQuery","text":"<p>The AGRPortfolioQuery is used by the AGR to retrieve additional information on the connections.</p> <pre><code>&lt;AGRPortfolioQuery\n  Metadata\u2026\n  Period = Date\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see section metadata attributes. Period The Period for which the AGR requests the portfolio information."},{"location":"message-descriptions/message-catalog/agr-portfolio-update-response/","title":"AGRPortfolioUpdateResponse","text":""},{"location":"message-descriptions/message-catalog/agr-portfolio-update-response/#agrportfolioupdateresponse","title":"AGRPortfolioUpdateResponse","text":"<p>Upon receiving and processing an AGRPortfolioUpdate message, the receiving implementation must reply with an AGRPortfolioUpdateResponse, indicating whether the update was handled successfully.</p> <pre><code>&lt;AGRPortfolioUpdateResponse\n  Metadata\u2026\n  ReferenceMessageID          = UUID\n  Result                      = (\"Accepted\" | \"Rejected\")\n  RejectionReadon             = String (only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the AGRPortfolioUpdate message Result Indication whether the AGRPortfolioUpdate was accepted or rejected. RejectionReason In case the AGRPortfolioUpdate was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/agr-portfolio-update/","title":"AGRPortfolioUpdate","text":""},{"location":"message-descriptions/message-catalog/agr-portfolio-update/#agrportfolioupdate","title":"AGRPortfolioUpdate","text":"<p>The AGRPortfolioUpdate is used by the AGR to indicate on which Connections it represents prosumers.</p> <pre><code>&lt;AGRPortfolioUpdate\n  Metadata\u2026\n  &lt;Connection       (0...n)\n    EntityAddress = EntityAddress\n    StartPeriod   = Date\n    EndPeriod     = Date (optional)\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. Connection \u21e5 EntityAddress EntityAddress of the Connection entity being updated. \u21e5 StartPeriod The first Period hat the AGR represents the prosumer at this Connection. \u21e5 EndPeriod The last Period that the AGR represents the prosumer at this Connection, if applicable."},{"location":"message-descriptions/message-catalog/d-prognosis-response/","title":"D-PrognosisResponse","text":""},{"location":"message-descriptions/message-catalog/d-prognosis-response/#d-prognosisresponse","title":"D-PrognosisResponse","text":"<p>Upon receiving and processing a prognosis message, the receiving implementation must reply with a D-PrognosisResponse, indicating whether the prognosis was syntactically and semantically valid, and, where any FlexOrder messages have previously been sent for any ISP in the period the prognosis applies to, a FlexOrderStatus indication for each of those orders.</p> <pre><code>&lt;D-PrognosisResponse\n  Metadata\u2026\n  ReferenceMessageID   = UUID\n  Result               = (\"Accepted\" | \"Rejected\")\n  RejectionReason      = String (Only if Result = \"Rejected\")\n  &lt;FlexOrderStatus       (0..n)\n    Sequence           = Long\n    IsValidated        = Boolean\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID Reference to the the D-prognosis that was accepted or rejected Result Indication whether the prognosis was accepted or rejected. A receiving implementation may reject a prognosis if it's syntactically invalid, uses a ISP duration or time zone that deviates from what is agreed upon for the market, is for a unknown Congestion Point or from an AGR that is not listed in the Common Reference, does not contain a full list of ISPs for the Period it applies to, contains implausible power values, applies to a Period for which all ISPs are already pending settlement, or if a Prognosis of the same type and from the same originator with a higher sequence number was already processed previously. RejectionReason In case the update was rejected, this attribute must contain a human-readable description of the failure. FlexOrderStatus Status of a previously submitted FlexOrder \u21e5 Sequence Sequence of the previously submitted FlexOrder. \u21e5 IsValidated Indication whether the Prognosis that was just received reflects this previously submitted FlexOrder."},{"location":"message-descriptions/message-catalog/d-prognosis/","title":"D-Prognosis","text":""},{"location":"message-descriptions/message-catalog/d-prognosis/#d-prognosis","title":"D-Prognosis","text":"<p>D-Prognosis messages are used to communicate D-prognoses between AGRs and DSOs. D-Prognosis messages always contain data for all ISPs for the period they apply to, even if a prognosis is sent after the start of the period, when one or more ISPs are already in the operate or settlement phase. Receiving implementations should ignore the information supplied for those ISPs.</p> <pre><code>&lt;D-Prognosis\n  Metadata\u2026\n  Period          = Period\n  CongestionPoint = EntityAddress\n  Revision        = Long\n  &lt;ISP              (1...n)\n    Power         = Integer\n    Start         = Integer\n    Duration      = Integer (optional, default = 1)\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. Period The Period this D-Prognosis applies to. CongestionPoint Entity Address of the Congestion Point this prognosis applies to. Required for D-prognoses, prohibited for other prognosis types. Revision Revision of this message. A sequence number that must be incremented each time a new revision of a prognosis is sent. The combination of SenderDomain and PrognosisSequence should be unique. ISP \u21e5 Power Power specified for this ISP in Watts. Also see the important notes about the sign of this attribute in the main documentation entry for the Power attribute. \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 Duration The number of the ISPs this element represents. <p>Note: Every day-ahead D-Prognosis must contain a Power value for every single ISP of the specified Period.</p>"},{"location":"message-descriptions/message-catalog/dso-portfolio-query-response/","title":"DSOPortfolioQueryResponse","text":""},{"location":"message-descriptions/message-catalog/dso-portfolio-query-response/#dsoportfolioqueryresponse","title":"DSOPortfolioQueryResponse","text":"<p>Upon receiving and processing a DSOPortfolioQuery message, the receiving implementation must reply with a DSOPortfolioQueryResponse, indicating whether the query executed successfully, and if it did, including the query results. Most queries will return zero or more congestion points</p> <pre><code>&lt;DSOPortfolioQueryResponse\n  Metadata\u2026\n  ReferenceMessageID         = UUID\n  Result                     = (\"Success\" | \"Failure\")\n  RejectionReason            = String (only if Result = \"Failure\")\n  Period                     = Date\n  &lt;CongestionPoint             (0..n, 0 if Result = \"Success\")\n    EntityAddress            = EntityAddress\n      &lt;Connection              (1..n)\n        EntityAddress        = EntityAddress\n        AGR-Domain           = InternetDomain (optional)\n      /&gt;\n   /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the DSOPortfolioQuery message Result Indication whether the query was executed successfully or failed. RejectionReason In case the query failed, this attribute must contain a human-readable description of the failure reason. Period The period that was queried. This is also the Period for which the portfolio is valid. CongestionPoint The congestion point that was queried. \u21e5 EntityAddress The entity address of the congestion point. \u21e5 Connection A Connection that is part of the congestion point. \u21e5 \u21e5 EntityAddress The entity address of the Connection \u21e5 \u21e5 AGR-Domain The internet domain of the AGR that represents the prosumer connected on this Connection, if applicable."},{"location":"message-descriptions/message-catalog/dso-portfolio-query/","title":"DSOPortfolioQuery","text":""},{"location":"message-descriptions/message-catalog/dso-portfolio-query/#dsoportfolioquery","title":"DSOPortfolioQuery","text":"<p>DSOPortfolioQuery is used by DSOs to discover which AGRs represent connections on its registered congestion point(s).</p> <pre><code>&lt;DSOPortfolioQuery\n  Metadata\u2026\n  EntityAddress = EntityAddress\n  Period        = Date\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. EntityAddress Entity Address of the CongestionPoint entity being queried. Period The Period being queried."},{"location":"message-descriptions/message-catalog/dso-portfolio-update-response/","title":"DSOPortfolioUpdateResponse","text":""},{"location":"message-descriptions/message-catalog/dso-portfolio-update-response/#dsoportfolioupdateresponse","title":"DSOPortfolioUpdateResponse","text":"<p>Upon receiving and processing a DSOPortfolioUpdate message, the receiving implementation must reply with a DSOPortfolioUpdateResponse, indicating whether the update was handled successfully.</p> <pre><code>&lt;DSOPortfolioUpdateResponse\n  Metadata\u2026\n  ReferenceMessageID          = UUID\n  Result                      = (\"Accepted\" | \"Rejected\")\n  RejectionReason             = String (only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the DSOPortfolioUpdate message Result Indication whether the DSOPortfolioUpdate was accepted or rejected. RejectionReason In case the DSOPortfolioUpdate was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/dso-portfolio-update/","title":"DSOPortfolioUpdate","text":""},{"location":"message-descriptions/message-catalog/dso-portfolio-update/#dsoportfolioupdate","title":"DSOPortfolioUpdate","text":"<p>The DSOPortfolioUpdate is used by the DSO to indicate on which congestion points it wants to engage in flexibility trading.</p> <pre><code>&lt;DSOPortfolioUpdate\n  Metadata\u2026\n  &lt;CongestionPoint         (0...n)\n    EntityAddress        = EntityAddress\n    StartPeriod          = Date\n    EndPeriod            = Date (optional)\n    MutexOffersSupported = Boolean\n    DayAheadRedispatchBy = (\"AGR\" | \"DSO\" )\n    IntradayRedispatchBy = (\"AGR\" | \"DSO\" ) (optional)\n    &lt;Connection            (1...n)\n      EntityAddress      = EntityAddress\n      StartPeriod        = Date\n      EndPeriod          = Date (optional)\n    /&gt;\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. CongestionPoint \u21e5 EntityAddress Entity Address of the CongestionPoint entity being updated. \u21e5 StartPeriod The first Period that the DSO is trading on this CongestionPoint. \u21e5 EndPeriod The last Period that the DSO is trading on this CongestionPoint. \u21e5 MutexOffersSupported Indicates whether the DSO accepts mutual exclusive FlexOffers on this CongestionPoint \u21e5 DayAheadRedispatchBy Indicates which party is responsible for day-ahead redispatch, AGR or DSO. \u21e5 IntradayRedispatchBy Indicates which party is responsible for intraday ahead redispatch, AGR or DSO. If not specified, there will be no intraday trading on this CongestionPoint. \u21e5 Connection \u21e5 \u21e5 EntityAddress Entity Address of a Connection that is part of this CongestionPoint. \u21e5 \u21e5 StartPeriod The first Period that the Connection is part of this CongestionPoint. Notes: <ul><li>The StartPeriod of a Connection should be greater than or equal to the StartPeriod of the CongestionPoint.</li><li>The StartPeriod of a Connection should be smaller than or equal to the EndPeriod of the CongestionPoint.</li><li>CRO implementors may choose to explicitly check for this and reject updates that do not comply.</li></ul> \u21e5 \u21e5 EndPeriod The last Period that the Connection is part of this CongestionPoint. Notes: <ul><li>The EndPeriod of a Connection should be null if and only if the EndPeriod of the CongestionPoint is null.The EndPeriod of a Connection should be greater than or equal to the StartPeriod of the CongestionPoint.</li><li>The EndPeriod of a Connection should be smaller than or equal to the EndPeriod of the CongestionPoint.</li><li>CRO implementors may choose to explicitly check for this and reject updates that do not comply.</li></ul>"},{"location":"message-descriptions/message-catalog/flex-offer-response/","title":"FlexOfferResponse","text":""},{"location":"message-descriptions/message-catalog/flex-offer-response/#flexofferresponse","title":"FlexOfferResponse","text":"<p>Upon receiving and processing a FlexOffer message, the receiving implementation must reply with a FlexOfferResponse, indicating whether the flexibility offer was processed successfully.</p> <pre><code>&lt;FlexOfferResponse\n  Metadata\u2026\n  ReferenceMessageID = UUID\n  Result             = (\"Accepted\" | \"Rejected\")\n  RejectionReason    = String (Only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the FlexOffer that has been accepted or rejected. Result Indication whether the flex offer was accepted or rejected. Rejection is allowed in case no matching FlexRequest can be found, or the FlexOffer does not contain a valid price for each ISP with Disposition=Requested in the corresponding FlexRequest. RejectionReason In case the offer was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/flex-offer-revocation-response/","title":"FlexOfferRevocationResponse","text":""},{"location":"message-descriptions/message-catalog/flex-offer-revocation-response/#flexofferrevocationresponse","title":"FlexOfferRevocationResponse","text":"<p>Upon receiving and processing a FlexOfferRevocation message, the receiving implementation must reply with a FlexOfferRevocationResponse, indicating whether the revocation was handled successfully.</p> <pre><code>&lt;FlexOfferRevocationResponse\n  Metadata...\n  ReferenceMessageID = UUID\n  Result             = (\"Accepted\" | \"Rejected\")\n  RejectionReason    = String (Only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the FlexOfferRevocation that has been accepted or rejected. Result Indication whether the revocation was accepted or rejected. Rejection is allowed in case the FlexOffer is unknown (it is the responsibility of the sending party not to revoke FlexOffer messages that have not yet been accepted), or the offered flexibility has already been ordered. RejectionReason In case the revocation was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/flex-offer-revocation/","title":"FlexOfferRevocation","text":""},{"location":"message-descriptions/message-catalog/flex-offer-revocation/#flexofferrevocation","title":"FlexOfferRevocation","text":"<p>The FlexOfferRevocation message is used by the AGR to revoke a FlexOffer previously sent to a DSO. It voids the FlexOffer, even if its validity time has not yet expired. Revocation is not allowed for FlexOffers that already have associated accepted FlexOrders.</p> <pre><code>&lt;FlexOfferRevocation\n  Metadata...\n  FlexOfferMessageID = UUID\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. FlexOfferMessageID MessageID of the FlexOffer message that is being revoked: this FlexOffer must have been accepted previously."},{"location":"message-descriptions/message-catalog/flex-offer/","title":"FlexOffer","text":""},{"location":"message-descriptions/message-catalog/flex-offer/#flexoffer","title":"FlexOffer","text":"<p>FlexOffer messages are used by AGRs to make DSOs an offer for provision of flexibility. A FlexOffer message contains a list of ISPs and, for each ISP, the change in consumption or production offered and the price for the total amount of flexibility offered. FlexOffer messages can be sent once a FlexRequest message has been received but can also be sent unsolicited. Note that multiple FlexOffer messages may be sent based on a single FlexRequest, e.g. to increase the chance that the DSO will order at least part of its available flexibility. The AGR must make sure that it can actually provide the flexibility offered across all of its FlexOffers.</p> <pre><code>&lt;FlexOffer\n  Metadata\u2026\n  Period                = Period\n  CongestionPoint       = EntityAddress\n  ExpirationDateTime    = DateTime\n  FlexRequestMessageID  = UUID (mandatory if and only if solicited)\n  ContractID            = Text (only if this offer refers to a bilateral contract)\n  D-PrognosisMessageID  = UUID (mandatory if and only if unsolicited)\n  BaselineReference     = Text (only if another baseline methodology is used)\n  Currency              = ISO4217Currency\n  &lt;OfferOption            (1...n)\n    OptionReference     = String (only if there are multiple OfferOptions)\n    Price               = ISO4217Currency\n    MinActivationFactor = Number (optional [0.01-1.00])\n    &lt;ISP                  (1...n)\n      Power             = Integer\n      Start             = Integer\n      Duration          = Integer (optional, default = 1)\n    /&gt;\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see section metadata attributes. Period The Period the ISPs referenced in this FlexOffer message belong to. CongestionPoint Entity Address of the Congestion Point this FlexOffer message applies to. ExpirationDateTime Date and time, including the time zone (ISO 8601 formatted as per http://www.w3.org/TR/NOTE-datetime) until when the FlexOffer message is valid. FlexRequestMessageID MessageID of the FlexRequest message this request is based on. ContractID Reference to the concerning bilateral contract, if applicable. D-PrognosisMessageID MessageID of the D-Prognosis this request is based on, if it has been agreed that the baseline is based on D-prognoses. BaselineReference Identification of the baseline prognosis, if another baseline methodology is used than based on D-prognoses. Currency ISO 4217 code indicating the currency that applies to the price of the FlexOffer. OfferOption If the DSO does not support mutually exclusive offers it will reject FlexOffers that contain more than one OfferOption. \u21e5 OptionReference The identification of this option \u21e5 Price The asking price for the flexibility offered in this option. \u21e5 MinActivationFactor The minimal activation factor for this OfferOption. If this attribute is omitted, a default value of 1.00 must be assumed.An AGR may choose to include MinActivationFactor in FlexOffers even if the  DSO is not interested in partial activation. In that case the DSO will simply use an ActivationFactor of 1.00 in every FlexOrder. \u21e5 ISP \u21e5 \u21e5 Disposition Optional, used only for FlexRequest messages: indication whether the Power specified for this ISP represents available capacity or a request for reduction/increase. \u21e5 \u21e5 Power Power specified for this ISP in Watts. Also see the important notes about the sign of this attribute in the main documentation entry for the ISP element, section power. \u21e5 \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 \u21e5 Duration The number of the ISPs this element represents. Optional, default value is 1."},{"location":"message-descriptions/message-catalog/flex-order-response/","title":"FlexOrderResponse","text":""},{"location":"message-descriptions/message-catalog/flex-order-response/#flexorderresponse","title":"FlexOrderResponse","text":"<p>Upon receiving and processing a FlexOrder message, the receiving implementation must reply with a FlexOrderResponse, indicating whether the update was handled successfully.</p> <pre><code>&lt;FlexOrderResponse\n  Metadata\u2026\n  ReferenceMessageID = UUID\n  Result             = (\"Accepted\" | \"Rejected\")\n  RejectionReason    = String (Only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the FlexOrder that has just been accepted or rejected. Result Indication whether the order was accepted or rejected. Rejection is only allowed in case the FlexOrder was already accepted previously, cannot be found, or does not exactly match the contents of the corresponding FlexOffer. RejectionReason In case the order was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/flex-order/","title":"FlexOrder","text":""},{"location":"message-descriptions/message-catalog/flex-order/#flexorder","title":"FlexOrder","text":"<p>FlexOrder messages are used by DSOs to purchase flexibility from an AGR based on a previous FlexOffer. A FlexOrder message contains a list of ISPs, with, for each ISP, the change in consumption or production to be realized by the AGR, and the accepted price to be paid by the DSO for this amount of flexibility. This ISP list should be copied from the FlexOffer message without modification: AGR implementations will (and must) reject FlexOrder messages where the ISP list is not exactly the same as offered.</p> <pre><code>&lt;FlexOrder\n  Metadata\u2026\n  Period               = Period\n  CongestionPoint      = EntityAddress\n  FlexOfferMessageID   = UUID\n  ContractID           = Text (only if the offer and order refer to a bilateral contract)\n  D-PrognosisMessageID = UUID (if present)\n  BaselineReference    = Text (if present)\n  Price                = CurrencyAmount\n  Currency             = ISO4217Currency\n  OrderReference       = String\n  OptionReference      = String\n  ActivationFactor     = Number (optional [0.01-1.00])\n  &lt;ISP                  (1...n)\n    Power              = Integer\n    Start              = Integer\n    Duration           = Integer (optional, default = 1)\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. Period Period the ISPs referenced in this FlexOrder message belong to. CongestionPoint Entity Address of the Congestion Point this FlexOrder message applies to FlexOfferMessageID MessageID of the FlexOffer message this order is based on. ContractID Reference to the bilateral contract in question, if applicable. D-PrognosisMessageID MessageID of the D-Prognosis this order is based on, if present BaselineReference Identification of the baseline prognosis, if another baseline methodology is used than based on D-prognoses. Price The price for the flexibility ordered. Usually, the price should match the price of the related FlexOffer. Currency ISO 4217 code indicating the currency that applies to the price of the FlexOrder. OrderReference Order number assigned by the DSO originating the FlexOrder. To be stored by the AGR and used in the settlement phase. OptionReference The OptionReference from the OfferOption chosen from the FlexOffer. ActivationFactor The activation factor for this OfferOption. If this  attribute is omitted, a default value of  1.00 must be assumed.Notes:The ActivationFactor must be greater than or equal to the MinActivationFactor in the OfferOption chosen from the FlexOffer. ISP \u21e5 Power Power specified for this ISP in Watts. Also see the important notes about the sign of this attribute in the main documentation entry for the ISP element, section power. \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 Duration The number of the ISPs this element represents. Optional, default value is 1."},{"location":"message-descriptions/message-catalog/flex-request-response/","title":"FlexRequestResponse","text":""},{"location":"message-descriptions/message-catalog/flex-request-response/#flexrequestresponse","title":"FlexRequestResponse","text":"<p>Upon receiving and processing a FlexRequest message, the receiving implementation must reply with a FlexRequestResponse, indicating whether the flexibility request was processed successfully.</p> <pre><code>&lt;FlexRequestResponse\n  Metadata\u2026\n  ReferenceMessageID   = UUID\n  Result               = (\"Accepted\" | \"Rejected\")\n  RejectionReason      = String (Only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the FlexRequest that has been accepted or rejected. Result Indication whether the flex request was accepted or rejected. Rejection is allowed in case the FlexRequest is not based on our latest Prognosis, a FlexRequest from the same participant for the indicated period with a higher sequence number was already accepted previously or the FlexRequest does not contain any ISPs with Disposition=Requested. RejectionReason In case the request was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/flex-request/","title":"FlexRequest","text":""},{"location":"message-descriptions/message-catalog/flex-request/#flexrequest","title":"FlexRequest","text":"<p>FlexRequest messages are used by DSOs to request flexibility from AGRs. In addition to one or more ISP elements with Disposition=Requested, indicating the actual need to reduce consumption or production, the message should also include the remaining ISPs for the current period where Disposition=Available.</p> <pre><code>&lt;FlexRequest\n  Metadata\u2026\n  Period             = Period\n  ContractID         = String (optional)\n  ServiceType        = String (optional)\n  CongestionPoint    = EntityAddress\n  Revision           = Long\n  ExpirationDateTime = DateTime\n  &lt;ISP                 (1...n)\n    Disposition      = \"Available\" | \"Requested\"\n    MinPower         = Integer\n    MaxPower         = Integer\n    Start            = Integer\n    Duration         = Integer (optional, default = 1)\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. Period The Period this FlexRequest message applies to. ContractID Reference to the concerning contract, if applicable. The contract may be either bilateral or commoditized market contract. ServiceType Service type for this request, the service type determines response characteristics such as latency or asset participation type. Each contract may specify multiple service-types. CongestionPoint Entity Address of the Congestion Point this FlexRequest message applies to. Revision Revision of this message, a sequence number that must be incremented each time a new revision of a FlexRequest message is sent. ExpirationDateTime Date and time, including the time zone (ISO 8601 formatted as per http://www.w3.org/TR/NOTE-datetime) until when the FlexRequest message is valid. ISP \u21e5 Disposition indication whether the Power specified for this ISP represents available capacity or a request for reduction/increase.At least one ISP should have Disposition = Requested \u21e5 MinPower Lower bound for\u00a0available/requested space to deviate from\u00a0the baseline (in Watts).For further explanation, see section Flexibility trading between the AGR and DSO. Also see the important notes about the sign of this attribute in the ISP element, section power. \u21e5 MaxPower Upper bound for available/requested space to deviate from the baseline (in Watts).For further explanation, see section Flexibility trading between the AGR and DSO. Also see the important notes about the sign of this attribute in the ISP element, section power. \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 Duration The number of the ISPs this element represents. Optional, default value is 1."},{"location":"message-descriptions/message-catalog/flex-reservation-update-response/","title":"FlexReservationUpdateReponse","text":""},{"location":"message-descriptions/message-catalog/flex-reservation-update-response/#flexreservationupdateresponse","title":"FlexReservationUpdateResponse","text":"<p>Upon receiving and processing a FlexReservationUpdate message, the AGR must reply with a FlexReservationUpdateResponse, indicating whether the FlexReservationUpdate was processed successfully.</p> <pre><code>&lt;FlexReservationUpdateResponse\n  Metadata\u2026\n  ReferenceMessageID             = UUID\n  Result                         = (\"Accepted\" | \"Rejected\")\n  RejectionReason                = String (only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see section metadata attributes. ReferenceMessageID MessageID  of the concerning FlexReservationUpdate message Result Indication whether the FlexReservationUpdate was accepted or rejected. Rejection is allowed in case the FlexReservationUpdate does not match the bilateral contract or its agreements or the deadline for sending the update has expired. RejectionReason In case the request was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/flex-reservation-update/","title":"FlexReservationUpdate","text":""},{"location":"message-descriptions/message-catalog/flex-reservation-update/#flexreservationupdate","title":"FlexReservationUpdate","text":"<p>For bilateral contracts, FlexReservationUpdate messages are used by DSOs to signal to an AGR which part of the contracted volume is still reserved and which part is not needed and may be used for other purposes. For each ISP, a power value is given which indicates how much power is still reserved. Zero power means that no power is reserved for that ISP and the sign of the power indicates the direction.</p> <pre><code>&lt;FlexReservationUpdate\n  Metadata\u2026\n  Period          = Period\n  CongestionPoint = EntityAddress\n  ContractID      = Text\n  Reference       = String\n  &lt;ISP              (1...n)\n    Power         = Integer\n    Start         = Integer\n    Duration      = Integer (optional, default = 1)\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see section metadata attributes. Period The Period this FlexRequest message applies to. CongestionPoint Entity Address of the Congestion Point this FlexRequest message applies to. ContractID Reference to the bilateral contract in question. Reference Message reference, assigned by the DSO originating the FlexReservationUpdate. ISP \u21e5 Power Remaining reserved power specified for this ISP in Watts. See important notes about the flex reservation mechanism. \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 Duration The number of the ISPs this element represents. Optional, default value is 1."},{"location":"message-descriptions/message-catalog/flex-settlement-response/","title":"FlexSettlementResponse","text":""},{"location":"message-descriptions/message-catalog/flex-settlement-response/#flexsettlementresponse","title":"FlexSettlementResponse","text":"<p>Upon receiving and processing a FlexSettlement message, the AGR must reply with a FlexSettlementResponse, indicating whether the initial message was handled successfully. When a FlexSettlement message is rejected, the DSO should consider all FlexOrderSettlement elements of that message related to potential dispute.</p> <pre><code>&lt;FlexSettlementResponse\n  Metadata\u2026\n  ReferenceMessageID         = UUID\n  Result                     = (\"Accepted\" | \"Rejected\")\n  RejectionReason            = String (Only if Result = \"Rejected\")\n  &lt;FlexOrderSettlementStatus   (0...n, only if Result = \"Accepted\")\n    OrderReference           = String\n    Disposition              = (\"Accepted\" | \"Disputed\")\n    DisputeReason            = String (Only if Disposition = \"Disputed\")\n  /&gt;\n  &lt;ContractSettlementStatus    (0...n, only if Result = \"Accepted\")\n    ContractID               = Text\n    &lt;Period                    (0...n)\n      Period                 = Period\n      &lt;ISP                     (0...n)\n        Start                = Integer\n        Duration             = Integer (optional, default = 1)\n        Disposition          = (\"Accepted\" | \"Disputed\")\n        DisputeReason        = String (Only if Disposition = \"Disputed\")\n      /&gt;\n    /&gt;\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the FlexSettlement that has just been accepted or rejected Result Indication whether the message was accepted or rejected. Rejection is only allowed in case a FlexSettlement covering a given period was already accepted previously, or contains invalid data. If one or more settlement items included in the message are not in accordance with the AGR\u2019s accounting, the message should still be accepted, and the dispute communicated using the appropriate FlexOrderSettlementStatus elements. RejectionReason In case the message was rejected, this attribute must contain a human-readable description of the reason. FlexOrderSettlementStatus Each FlexOrderSettlementStatus element indicates whether the settlement details about a FlexOrder, included in the corresponding FlexOrderSettlement element, are accepted or disputed by the AGR. \u21e5 OrderReference Order reference assigned by the DSO when originating the FlexOrder. \u21e5 Disposition Indication whether the AGR accepts the order settlement details provided by the DSO (and will invoice accordingly), or disputes these details. \u21e5 DisputeReason In case the order settlement was disputed, this attribute must contain a human-readable description of the reason. ContractSettlementStatus Each ContractSettlementStatus element indicates whether the settlement details about a bilateral contract, included in the corresponding ContractSettlement element, are accepted or disputed by the AGR. \u21e5 ContractID Reference to the concerning bilateral contract. \u21e5 Period List of all periods from the ContractSettlement, including possible lacking periods \u21e5 \u21e5 Period Period the settlement status refers to. \u21e5 \u21e5 ISP \u21e5 \u21e5 \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 \u21e5 \u21e5 Duration The number of ISPs this element represents. It is recommended to merge consecutive ISPs with the same disposition. \u21e5 \u21e5 \u21e5 Disposition Indication whether the AGR accepts the settlement details as provided by the DSO from the ISP(s) in question (and will invoice accordingly), or disputes these details. \u21e5 \u21e5 \u21e5 DisputeReason In case the settlement from the ISP(s) was disputed, this attribute must contain a human-readable description of the reason. <p>Handling disputed settlement details is a manual process outside the UFTP scope.</p>"},{"location":"message-descriptions/message-catalog/flex-settlement/","title":"FlexSettlement","text":""},{"location":"message-descriptions/message-catalog/flex-settlement/#flexsettlement","title":"FlexSettlement","text":"<p>The FlexSettlement message is sent by DSOs on a regular basis (typically monthly) to AGRs, in order to initiate settlement. It includes a list of all FlexOrders placed by the originating party during the settlement period.</p> <pre><code>&lt;FlexSettlement\n  Metadata\u2026\n  PeriodStart            = Period\n  PeriodEnd              = Period\n  Currency               = ISO4217Currency\n  &lt;FlexOrderSettlement     (0...n)\n    Period               = Period\n    ContractID           = Text (only if the offer and order refer to a bilateral contract)\n    D-PrognosisMessageID = UUID(only if it has been agreed that the baseline is based on D-prognoses)\n    BaselineReference    = Text (only if another baseline methodology is used)\n    OrderReference       = String\n    CongestionPoint      = EntityAddress\n    Price                = CurrencyAmount\n    Penalty              = CurrencyAmount (optional)\n    NetSettlement        = CurrencyAmount\n    &lt;ISP                   (0...n)\n      Start              = Integer\n      Duration           = Integer (optional, default = 1)\n      BaselinePower      = Integer\n      OrderedFlexPower   = Integer\n      ActualPower        = Integer\n      DeliveredFlexPower = Integer\n      PowerDeficiency    = Integer (optional)\n    /&gt;\n  /&gt;\n  &lt;ContractSettlement      (0...n, only in case of bilateral contracts)\n    ContractID           = Text\n    &lt;Period                (0...n)\n      Period             = Period\n      &lt;ISP                 (0...n)\n        Start            = Integer\n        Duration         = Integer (optional, default = 1)\n        ReservedPower    = Integer\n        RequestedPower   = Integer (optional, only if present)\n        AvailablePower   = Integer (optional)\n        OfferedPower     = Integer (optional, only if present)\n        OrderedPower     = Integer (optional, only if present)\n      /&gt;\n    /&gt;\n  /&gt;\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. PeriodStart First Period of the settlement period this message applies to. PeriodEnd Last Period of the settlement period this message applies to. Currency ISO 4217 code indicating the currency that applies to all amounts (flex price, penalty and net settlement) in this message. FlexOrderSettlement \u21e5 Period Period the FlexOrder refers to. \u21e5 ContractID Reference to the concerning bilateral contract, if it is linked to it. \u21e5 MessageID MessageID  of the Prognosis message (more specifically: the D-Prognosis) the FlexOrder is based on, if it has been agreed that the baseline is based on D-prognoses. \u21e5 BaselineReference Identification of the baseline prognosis, if another baseline methodology is used than based on D-prognoses. \u21e5 OrderReference Order reference assigned by the DSO when originating the FlexOrder. \u21e5 CongestionPoint Entity Address of the Congestion Point the FlexOrder applies to. \u21e5 Price The price accepted for supplying the ordered amount of flexibility as per the referenced FlexOrder messages. \u21e5 Penalty Optional (default zero) penalty due a non-zero PowerDeficiency. \u21e5 NetSettlement Net settlement amount for this Period: Price minus Penalty \u21e5 ISP \u21e5 \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 \u21e5 Duration The number of ISPs this element represents. Optional, default value is 1. \u21e5 \u21e5 BaselinePower Power originally forecast (as per the referenced baseline) for this ISP in Watts. \u21e5 \u21e5 OrderedFlexPower Amount of flex power ordered (as per the referenced FlexOrder message) for this ISP in Watts. \u21e5 \u21e5 ActualPower Actual amount of power for this ISP in Watts, as measured/determined by the DSO and allocated to the AGR. \u21e5 \u21e5 DeliveredFlexPower Actual amount of flex power delivered for this ISP in Watts, as determined by the DSO. \u21e5 \u21e5 PowerDeficiency Optional (default zero) amount of flex power sold but not delivered for this ISP in Watts, as determined by the DSO. ContractSettlement \u21e5 ContractID Reference to the bilateral contract in question. \u21e5 Period List of periods containing reservations \u21e5 \u21e5 Period Period the settlement refers to. \u21e5 \u21e5 ISP \u21e5 \u21e5 \u21e5 Start Number of the first ISP this element refers to. The first ISP of a day has number 1. \u21e5 \u21e5 \u21e5 Duration The number of ISPs this element represents. Optional, default value is 1. \u21e5 \u21e5 \u21e5 ReservedPower Amount of flex power that has been reserved (and not released using a FlexReservationUpdate message) \u21e5 \u21e5 \u21e5 RequestedPower Amount of flex power that has been both reserved in advance and has been requested using a FlexRequest (i.e. the lowest amount of flex power for this ISP). If there was no FlexRequest, this field is omitted. \u21e5 \u21e5 \u21e5 AvailablePower Amount of flex power that is considered available based on the FlexRequest in question.In case RequestedPower=0, AvailablePower is defined so that the offered power is allowed to be between 0 and AvailablePower in terms of compliancy (see Flex reservation mechanism for details).In case RequestedPower \u22600, AvailablePower is defined so that the offered power is allowed to exceed the amount of requested power up to AvailablePower.If this is relevant for settlement, the DSO can include this field. \u21e5 \u21e5 \u21e5 OfferedPower Amount of flex power that has been reserved in advance, requested using a FlexRequest and covered in an offer from the AGR. If there was no offer, this field is omitted. If there were multiple offers, only the one is considered that is most compliant (see Flex reservation mechanism for details about compliancy). \u21e5 \u21e5 \u21e5 OrderedPower Amount of flex power that has been ordered using a FlexOrder message that was based on a FlexOffer, both linked to this contract. If there was no order, this field is omitted."},{"location":"message-descriptions/message-catalog/metadata-attributes/","title":"Metadata attributes","text":""},{"location":"message-descriptions/message-catalog/metadata-attributes/#metadata-attributes","title":"Metadata attributes","text":"<p>The Metadata attributes contain metadata that are common for each non-wrapper USEF message.</p> <p>XML representation summary</p> <pre><code>SenderDomain    = InternetDomain\nRecipientDomain = InternetDomain\nTimeStamp       = DateTime\nMessageID       = UUID\nConversationID  = UUID\nISP-Duration    = Duration\nTimeZone        = TimezoneName\nVersion         = SpecVersion\n</code></pre> SenderDomain The Internet domain of the USEF participant sending this message. When receiving a message, its value should match the value specified in the SignedMessage wrapper: otherwise, the message must be rejected as invalid. When replying to this message, this attribute, combined with the SenderRole, is used to look up the USEF endpoint the reply message should be delivered to. RecipientDomain Internet domain of the participant this message is intended for. When sending a message this attribute is used to look up the Shapeshifter endpoint the message should be delivered to. TimeStamp Date and time this message was created, including the time zone (ISO 8601 formatted as per http://www.w3.org/TR/NOTE-datetime). MessageID Unique identifier (UUID/GUID as per IETF RFC 4122) for this message, to be generated when composing each message. ConversationID Unique identifier (UUID/GUID as per IETF RFC 4122) used to correlate responses with requests, to be generated when composing the first message in a conversation and subsequently copied from the original message to each reply message. ISP-Duration ISO 8601 time interval (minutes only, for example PT15M) indicating the duration of the ISPs referenced in this message. Although the ISP length is a market-wide fixed value, making this assumption explicit in relevant messages is important for validation purposes, allowing implementations to reject messages with an errant ISP duration.Only messages that refer to individual ISPs must include this attribute in the metadata. TimeZone Time zone ID (as per the IANA time zone database, http://www.iana.org/time-zones, for example: Europe/Amsterdam) indicating the UTC offset that applies to the Period referenced in this message. Although the time zone is a market-wide fixed value, making this assumption explicit in relevant messages is important for validation purposes, allowing implementations to reject messages with an errant UTC offset.Only messages that refer to a specific Period must include this attribute in the metadata. Version Shapeshifter specification version following semantic versioning rules e.g. 3.0.0"},{"location":"message-descriptions/message-catalog/metering-response/","title":"MeteringResponse","text":""},{"location":"message-descriptions/message-catalog/metering-response/#meteringresponse","title":"MeteringResponse","text":"<p>Upon receiving and processing a Metering message, the receiving implementation must reply with a MeteringResponse, indicating whether the update was handled successfully.</p> <pre><code>&lt;MeteringResponse\n  Metadata\u2026\n  ReferenceMessageID = UUID\n  Result             = (\"Accepted\" | \"Rejected\")\n  RejectionReason    = String (Only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see section metadata attributes. ReferenceMessageID MessageID of the Metering message that has just been accepted or rejected. Result Indication whether the order was accepted or rejected. RejectionReason In case the metering was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/metering/","title":"Metering","text":""},{"location":"message-descriptions/message-catalog/metering/#metering","title":"Metering","text":"<p>The Metering message is an optional message. The DSO will specify whether metering messages are required for a given program. If metering messages are used then the AGR must send metering messages, with one message sent per connection point per day. The metering messages must all be sent before the settlement can be performed. It is recommend to send the metering messages daily, once the metering data has been collected for the day.</p> <pre><code>&lt;Metering\n  Metadata\u2026\n  Period        = Period\n  EAN           = EntityAddress\n  Currency      = ISO4217Currency (optional field, no longer used)\n  &lt;Profile        (1...n)\n    ProfileType = MeteringProfileEnum\n    Unit        = MeteringUnitType\n    &lt;ISP          (1...n)\n      Value     = Integer\n      Start     = Integer\n    /&gt;\n  /&gt;\n/&gt;\n</code></pre> <p>The profile types to use will be agreed between the DSO and AGR and all agreed profile types must be included. It is recommended to include the Power profile and in a following major version the Power profile will become a mandatory profile.</p> <p>Note: The power profile represents the average active power during ISP, considering both import and export energy. Power=(ImportEnergy-ExportEnergy)*(60/ISP-Length-Minutes). For example with a 15 minute ISP length we have a multiplier of 4, with a 30 minute ISP length we have a multiplier of 2.</p> Metadata The metadata for this message. For details, see section metadata attributes Period The day that the metering data covers EAN The connection ID which this data refers to Profile A profile carries a sequence of ISPs with a defined type of metering data \u21e5 ProfileType A value from the ProfileType enum, one of Power, ImportEnergy, ExportEnergy, ImportMeterReading, ExportMeterReading \u21e5 Unit MeteringUnit type, use kW for Power and kWh for energy profile types. \u21e5 ISP \u21e5 \u21e5 Start Number of the ISP this element refers to. The first ISP of a day has number 1. \u21e5 \u21e5 Value Metering, energy or price value at the end of this ISP, in the designated profile units"},{"location":"message-descriptions/message-catalog/power/","title":"Power","text":""},{"location":"message-descriptions/message-catalog/power/#power","title":"Power","text":"<p>Power values occur in many USEF messages. The sign of a power value is used to distinguish between production and consumption, from the perspective of the prosumer. A positive value indicates that power flows towards the prosumer (consumption), a negative value indicates flow towards the grid (production). The following statements are true for ISP elements in all USEF messages:</p> <ul> <li>Each ISP in a period may only be addressed once.</li> <li>ISP elements may not cross period boundaries.</li> </ul>"},{"location":"message-descriptions/message-catalog/signed-message/","title":"SignedMessage","text":""},{"location":"message-descriptions/message-catalog/signed-message/#signedmessage","title":"SignedMessage","text":"<p>The SignedMessage element represents the secure wrapper used to submit USEF XML messages from the local message queue to the message queue of a remote participant. It contains minimal metadata (which is distinct from the common metadata used for all other messages), allowing the recipient to look up the sender's cryptographic scheme and public keys, and the actual XML message, as transformed (signed/sealed) using that cryptographic scheme.</p> <p>XML representation summary</p> <pre><code>&lt;SignedMessage\n  SenderDomain = InternetDomain\n  SenderRole   = (\"AGR\" | \"CRO\" | \"DSO\")\n  Body         = base64Binary\n/&gt;\n</code></pre> SenderDomain The Internet domain of the USEF participant sending this message. Upon receiving a message, the recipient should validate that its value matches the corresponding attribute value specified in the inner XML message, once un-sealed: if not, the message must be rejected as invalid.Domain name matching regular expression <code>^([a-z0-9]+(-[a-z0-9]+)*\\.)+[a-z]{2,}$</code> SenderRole The USEF role of the participant sending this message: AGR, CRO or DSO. Receive-time validation should take place as described for the SenderDomain attribute above. The USEF specification identifies additional roles such as BRP and MDC. These are however not in scope of UFTP. Body The Base-64 encoded inner XML message contained in this wrapper, as transformed (signed/sealed) using the sender's cryptographic scheme. The recipient can determine which scheme applies using a DNS or configuration file lookup, based on the combination of SenderDomain and SenderRole."},{"location":"message-descriptions/message-catalog/test-message-response/","title":"TestMessageResponse","text":""},{"location":"message-descriptions/message-catalog/test-message-response/#testmessageresponse","title":"TestMessageResponse","text":"<p>Upon receiving a TestMessage, the receiving implementation must reply with a TestMessageResponse. Like the TestMessage itself, the TestMessageResponse does not have any content (other than the mandatory metadata).</p> <pre><code>&lt;TestMessageResponse\n  Metadata...\n  ReferenceMessageID = UUID\n  Result             = (\"Accepted\" | \"Rejected\")\n  RejectionReason    = String (Only if Result = \"Rejected\")\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes. ReferenceMessageID MessageID of the TestMessage message that has just been accepted or rejected. Result Indication whether the TestMessage was accepted or rejected. RejectionReason In case the TestMessage was rejected, this attribute must contain a human-readable description of the reason."},{"location":"message-descriptions/message-catalog/test-message/","title":"TestMessage","text":""},{"location":"message-descriptions/message-catalog/test-message/#testmessage","title":"TestMessage","text":"<p>TestMessage does not have any content (other than the mandatory metadata) and may be used by implementations for (connectivity) testing purposes.</p> <p>XML representation summary</p> <pre><code>&lt;TestMessage\n  Metadata...\n/&gt;\n</code></pre> Metadata The metadata for this message. For details, see metadata attributes."},{"location":"use-case-descriptions/common-concepts/","title":"Common concepts","text":""},{"location":"use-case-descriptions/common-concepts/#common-concepts","title":"Common concepts","text":"<p>The USEF specification standardizes the logical interfaces and defines the minimum functionality of the components in the form of use cases (this chapter) and message transport specifications and message descriptions. This leaves room for innovation and possibilities to develop specific implementation architectures based on e.g. size of the market, specific local circumstances or commercial exploitation of USEF platforms. Stakeholders involved in a USEF market can and must develop business functions and capabilities independently, and focus on their core business and competitive advantage.</p> <p>While the USEF specification is technology and implementation agnostic, there are some basic principles to which any USEF implementation architecture must adhere. Some of these are listed as high-level requirements. When an ICT implementation architecture is defined, the actual implementation requirements must be defined and included in the design.</p> <ul> <li>A USEF market implementation will typically consist of multiple information systems interacting together according to the USEF interaction standard in order to run the market processes. The USEF foundation does not want to narrow down the open nature of the USEF specifications by defining exactly how the information system architecture must be implemented.</li> <li>The USEF specifications do not currently define exceptions and how to handle them. Therefore, the use cases also prescribe only the default main scenario without error handling, and only the successful outcome. The single exception to this rule is described in the next bullet. USEF does provide some recommended practices for handling some of the failure handling.</li> <li>Any USEF IT architecture must adhere to the USEF privacy &amp; security guideline.<sup>1</sup> In the USEF use cases the most relevant privacy &amp; security considerations are provided.</li> </ul> <ol> <li> <p>USEF Foundation, \"USEF: The Privacy and Security Guideline,\" USEF Foundation, Arnhem, 2015. Available: https://www.usef.energy/app/uploads/2016/12/USEF_PrivacySecurityGuideline_3nov15.pdf \u21a9</p> </li> </ol>"},{"location":"use-case-descriptions/message-validation/","title":"Message validation","text":""},{"location":"use-case-descriptions/message-validation/#message-validation","title":"Message validation","text":"<p>Incoming messages need to be validated by the recipient for their correctness. Validation of the semantics is performed by the HTTP over TLS (explained in Message transport mechanism), but the content still needs to be checked for possible discrepancies. If the message passes validation, a response message is sent with \u2018accepted\u2019 in the result field. If it fails validation, a response message is sent with \u2018rejected\u2019 in the result field, along with a description of the reason why the message is rejected in the RejectionReason field. Some causes to reject a message are specific for the type of message and are mentioned in the remainder of this chapter. Other causes are more generic and are listed in the table below.</p> <p>This list is not all-encompassing: stakeholders are allowed to formulate other reasonable causes to reject a message, as long as it is clearly explained in the RejectionReason field. Adding the cause of the rejection will facilitate in building a correct implementation.  This field can contain multiple reasons for rejections (separated by a semicolon).</p> RejectionReason Cause of rejection Applicable to messages Unknown SenderDomain (SignedMessage) SenderDomain specified in the SignedMessage is unknown to the receiving implementation. SM Invalid SenderRole The SenderRole specified in the SignedMessage is invalid. SM Invalid Sender combination The combination SenderDomain and SenderRole in the SignedMessage is invalid. SM Mismatch SenderDomain SenderDomain specified in the SignedMessage doesn't match with the SenderDomain in the inner XML message. SM &amp; All other message types Invalid SignedMessage The SignedMessage complies with the XSD schema, but failed to pass validation. SM Invalid Message Despite being schema-compliant, the syntax, type or semantics of the message were unacceptable for the receiving implementation. All message types Unknown RecipientDomain The RecipientDomain specified in the inner XML message is not known to the receiving implementation. All message types Unknown SenderDomain (message) SenderDomain specified in the message is unknown to the receiving implementation. All message types except SM Barred Sender This endpoint is explicitly blocking messages from this sender. SM Duplicate Identifier The MessageID attribute of the inner XML message is not unique, and has already been used for a message with different content. This message has been rejected. All message types except SM Already Submitted The MessageID attribute of the inner XML message is not unique, but since the message content is the same as that of a previously accepted message, this copy can be considered to be successfully submitted as well. All message types except SM ISP duration rejected The message specifies a ISP duration that is not the agreed-upon common value for the market in which it is used. All message types that contain ISP's: FRU, DP, FR, FO, FOR, M, FS, FS_R TimeZone rejected The message specifies a TimeZone that has a different UTC offset than is the agreed-upon common value for the market. All message types that contain Period: APQ, APQ_R, DPQ, DPQ_R, FRU, DP, FR, FO, FOR, M, FS, FS_R Invalid CongestionPoint Unknown CongestionPoint or the recipient is not active at this CongestionPoint. FRU, DP, FR, FO, FOR, FS Unknown &lt;MessageType&gt;MessageID reference The message the MessageID refers to is unknown.For &lt;MessageType&gt; the referenced MessageType can be filled in.For example: FlexRequestMessageID or D-PrognosisMessageID. APU_R, APQ_R, FRU_R, DP_R, FR_R, FO, FOF_R, FOFR, FOFR_R, FOR, FOR_R, M_R, FS, FS_R Reference Period mismatch The message the &lt;MessageType&gt;MessageID refers to contains a different Period. MessageTypes that refer to other messages using &lt;MessageType&gt;MessageID AND contain a Period themselves: APQ_R, FO FOFR, FOR, FS, FS_R Reference message expired The message &lt;MessageType&gt;MessageID refers to is expired. APU_R, APQ_R, FRU_R, DP_R, FR_R, FO, FOF_R, FOFR, FOFR_R, FOR, FOR_R, M_R, FS, FS_R Reference message revoked The message &lt;MessageType&gt;MessageID refers is revoked. APU_R, APQ_R, FRU_R, DP_R, FR_R, FO, FOF_R, FOFR, FOFR_R, FOR, FOR_R, M_R, FS, FS_R ISPs out of bounds One or more ISPs are outside the tolerated boundaries. - At least 1 ISP should exist in the messages that expect them. - Also, the amount of ISPs that are about a Period (one day) can never exceed (24 hours / ISP-Duration (in hours)) + DST_offsetWhat that means is that for example: you can't have more than (24 hours (1 Period) / 0.25 (PT15M)) = 96 ISPss. Exceptions are depending on wether or not DST applies (for Europe for example), then you have an hour less or more on the day so the maximums would in those cases be: 96 - 4 = 92 or 96 + 4 = 100. More ISPs for that specific Period would be invalid. FRU, DP, FR, FO, FOR, M, FS, FS_R ISP conflict One or more ISPs are defined more than once, possibly because of an incorrect duration.For example:<pre>&lt;FlexRequest  &lt;ISP Start = 1 Duration = 4 ... /&gt;  &lt;ISP Start = 2 Duration = 1 ... /&gt;/&gt;</pre> The second ISP will overlap the first. FRU, DP, FR, FO, FOR, M, FS, FS_R Period out of bounds Period of the message is inappropriate.For example: a FlexRequest with a Period in the past or a settlement item in a FlexSettlement with a Period outside the concerning settlement period. APQ, APQ_R, DPQ, DPQ_R, FRU, DP, FR, FO, FOR, M, FS, FS_R ExpirationDateTime out of bounds ExpirationDateTime is in the past or exceeds the ISPs in the message. The acceptable content can best be discussed and agreed upon between the sending and receiving parties. FR, FOF [Other reasonable cause] [Implementation specific rejection reason] TBD <p>Because typing all MessageTypes out in full takes a lot of space, a list of abbreviations has been created that can be used when communicating about the specification:</p> MessageType Abbreviation SignedMessage SM TestMessage TM TestMessageResponse TM_R AGRPortfolioUpdate APU AGRPortfolioUpdateResponse APU_R AGRPortfolioQuery APQ AGRPortfolioQueryResponse APQ_R DSOPortfolioUpdate DPU DSOPortfolioUpdateResponse DPU_R DSOPortfolioQuery DPQ DSOPortfolioQueryResponse DPQ_R FlexReservationUpdate FRU FlexReservationUpdateResponse FRU_R D-Prognosis DP D-PrognosisResponse DP_R FlexRequest FR FlexRequestResponse FR_R FlexOffer FOF FlexOfferResponse FOF_R FlexOfferRevocation FOFR FlexOfferRevocationResponse FOFR_R FlexOrder FOR FlexOrderResponse FOR_R Metering M MeteringResponse M_R FlexSettlement FS FlexSettlementResponse FS_R"},{"location":"use-case-descriptions/privacy-and-security-by-design/","title":"Privacy and security by design","text":""},{"location":"use-case-descriptions/privacy-and-security-by-design/#privacy-and-security-by-design","title":"Privacy and security by design","text":"<p>USEF \u2013 like most complex information systems \u2013 deals with sensitive data and therefore requires security and privacy preservation measures. Privacy &amp; security are system-wide issues; protection of individual subsystems/components is not enough; the system is as strong as the weakest link. USEF therefore follows the principle of privacy &amp; security by design.</p> <p>USEF provides a separate privacy and security guideline <sup>1</sup> that lists approximately 50 design principles which, combined, present a complete view of the privacy and security aspects associated with smart energy systems. It takes into account the current legal and social views on privacy &amp; security and links these to the future directions in which they will likely evolve.</p> <p>The guideline forms the basis for the logical security architecture that is reflected in USEF\u2019s process flows and use cases. Some remarks about security and responsibility:</p> <ul> <li>Personal and personally identifiable data represent commercially sensitive information. These include:<ul> <li>connection identifiers</li> <li>existence of congestion points</li> <li>details on AGRs associated to a connection</li> <li>portfolio data</li> <li>forecast data, content of D-prognoses and the fact whether or not a given AGR submitted a D-prognosis in a timely fashion</li> <li>the existence, content and timing of a flexibility request and other flexibility trading messages</li> <li>settlement items, including the acknowledgement or disputation of their correctness</li> </ul> </li> <li>Personal and personally identifiable data (such as forecasts or smart meter readings) should not be retained longer than strictly required. The retention period should be specified and be communicated to the data subject.</li> <li>The exact identity of the AGR for each connection should not be disclosed to the DSO. Instead, only aggregate connection counts should be provided (which represent commercially sensitive information).</li> <li>It is the responsibility of the CRO to have policies regarding access, data retention, data security and conflict resolution compliant with the USEF privacy &amp; security guidelines.</li> <li>The CRO should only disclose the existence of the congestion point on a need-to-know basis, i.e. only to those AGRs which provide an associated connection identifier in their queries.</li> </ul> <ol> <li> <p>USEF Foundation, \"USEF: The Privacy and Security Guideline,\" USEF Foundation, Arnhem, 2015. Available: https://www.usef.energy/app/uploads/2016/12/USEF_PrivacySecurityGuideline_3nov15.pdf \u21a9</p> </li> </ol>"},{"location":"use-case-descriptions/reading-guidelines/","title":"Reading guidelines","text":""},{"location":"use-case-descriptions/reading-guidelines/#reading-guidelines","title":"Reading guidelines","text":"<p>This chapter contains separate sections per USEF phase: Plan, Validate, Operate, and Settle. In each section the use cases are specified in a standard table format:</p> <p>Standard table format for USEF use cases.</p> Goal in context High-level description of the activity. Preconditions The state of the system that must be present prior to a use case being performed. Successful outcome The state the system will be in immediately after a use case has finished without failure. Failure outcome The state the system will be in immediately after a use case has finished after failure, plus identification of the failure."},{"location":"use-case-descriptions/scope/","title":"Scope","text":""},{"location":"use-case-descriptions/scope/#scope","title":"Scope","text":"<p>This chapter provides details of the functions that contain interactions relevant to the DSO and AGR, in order to be active in the USEF MCM. To be USEF compliant, these functions must be implemented according to the use case descriptions in this chapter.</p> <p>The use cases have been derived from the MCM sequence diagrams detailed in Chapter General description. Use cases are separate activities that require interaction between DSO and AGR, each containing multiple messages in both directions. DSO and AGR internal processes are not addressed in this chapter.</p> <p>The messages types that occur in these use cases are mentioned and further described in Section Message catalog.</p>"},{"location":"use-case-descriptions/scope/#introduction","title":"Introduction","text":"<p>The core of the USEF specification is the MCM and the processes governing it. These define how the different stakeholders active in the MCM should behave and interact. All use cases related to these functions are described to the extent relevant for the USEF specifications. All aspects not specified by USEF are explicitly mentioned. An example of this is that USEF does not specify how an AGR optimizes its portfolio or determines how much flexibility is available, where or when. The result of this portfolio optimization is, however, a prerequisite for participating in the flexibility bidding process.</p> <p>For the flexibility market to function, it is essential to have a functioning common reference populated with all AGR-represented connections.</p> <p>Given the open nature of the USEF specifications, any implementation can choose to adopt all or only part of the specifications. In any situation, all participants within a single USEF market will have to adopt a common specification of the market processes and information exchange.</p>"},{"location":"use-case-descriptions/use-cases/contract-phase/","title":"Contract phase","text":""},{"location":"use-case-descriptions/use-cases/contract-phase/#contract-phase","title":"Contract phase","text":"<p>In Contract phase the informative description of the contract phase processes has been given. In this chapter use cases will be described as derived from the contract phase.</p> <p>The USEF MCM contract phase specifies the following use cases:</p> <p>Use cases for the Contract phase.</p> Name Direction Message types Publish Congestion Points (Long-term) DSO \u2192 CRO DSOPortfolioUpdate / DSOPortfolioUpdateResponse Publish Connections AGR \u2192 CRO AGRPortfolioUpdate / AGRPortfolioUpdateResponse"},{"location":"use-case-descriptions/use-cases/contract-phase/#publish-congestion-points-long-term","title":"Publish Congestion Points (Long-term)","text":"<p>Once a flexibility market is functional for an area, the DSO has to update and publish a register of possible congestion points, including the connection identifiers of connected prosumers. This register is maintained by the Common Reference Operator. If operating in open mode, the CRO will accept updates from any USEF-compliant participants implementing the DSO role. In closed mode, participants will need to be pre-configured in order for updates to be accepted.</p> <p>Once populated, the common reference will allow AGRs to determine whether there are prosumers in their portfolio that can offer flexibility, via their connections, to one or more congestion points.</p> <p> </p> Exchange of congestion points including connections by DSO Publish Congestion Points / DSO Portfolio Goal in context In order to predict congestion and create a flex market: publish Congestion Points \u2013 including their associated Connections \u2013 to the Common Reference, so they become available to the AGRs. Preconditions Common Reference is available to DSO and AGRs Successful outcome The Common Reference is updated with the latest Congestion points and associated Connections (i.e. all connected Prosumers) Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; DSOPortfolioUpdate failed to pass validation by the CRO Unauthorized CRO is operating in closed mode and the DSO is not pre-registered as an authorized participant Subordinate sequence number The message sequence is lower than that of a previously received DSOPortfolioUpdate [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/contract-phase/#related-information","title":"Related information","text":"<p>It is the responsibility of the CRO to have policies regarding access, data retention, data security and conflict resolution compliant with the USEF privacy &amp; security guidelines. If the CRO detects strange behavior in the periods (e.g.an EndPeriod in the far past, an EndPeriod earlier than the StartPeriod or an EndPeriod of a congestion point earlier than the EndPeriod of a connection that it contains), it is up to the CRO to decide whether to reject the message, adjust the period or reply with a warning.</p> <p>A DSO can update its portfolio by retransmitting the DSOPortfolioUpdate. It is essential to use a sequence number that is incremented each time a new revision is sent so the order of transmission can be traced. To remove a congestion point, the DSO can transmit a new DSOPortfolioUpdate where the EndPeriod is the current time. The congestion point is then immediately expired. It is not necessary to add connections to this message since they will also expire.</p>"},{"location":"use-case-descriptions/use-cases/contract-phase/#publish-connections","title":"Publish Connections","text":"<p>Once a flexibility market is functional for an area, the AGR has to publish a list of the connection identifiers of the prosumers it has contracted. This list is stored and, subject to access controls, made available to other market participants by the CRO.</p> <p> </p> Exchange of connections by AGR Publish Congestion Points / DSO Portfolio Goal in context Publish all contracted Prosumer Connections in the Common Reference, in order to later discover Congestion Points and associated DSOs and to register the AGR\u2019s presence at Connections to the associated DSOs. Preconditions Common Reference is available to DSO and AGRs Successful outcome The Common Reference is updated with the all Prosumers (listed by their Connection identifiers) represented by the AGR. Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; AGRPortfolioUpdate failed to pass validation by the CRO Unauthorized CRO is operating in closed mode and the AGR is not pre-registered as an authorized participant Subordinate sequence number The message sequence is lower than that of a previously received DSOPortfolioUpdate [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/contract-phase/#related-information_1","title":"Related information","text":"<p>It is possible to transmit connection points to the CRO that have not yet been declared by the DSO.</p> <p>An AGR can update its portfolio by retransmitting the AGRPortfolioUpdate. It is essential to use a sequence number that is incremented each time a new revision is sent, so the order of transmission can be traced.</p>"},{"location":"use-case-descriptions/use-cases/operate-phase/","title":"Operate phase","text":""},{"location":"use-case-descriptions/use-cases/operate-phase/#operate-phase","title":"Operate phase","text":"<p>In Operate phase the informative description of the operate phase processes are provided. In this chapter, the use cases will be described as derived from the operate phase.</p> <p>The USEF MCM operate phase specifies the following use cases:</p> <p>Use cases for the operate phase.</p> Name Direction Message types Exchange updated D-Prognoses AGR \u2192 DSO Prognosis / PrognosisResponse Revocation Flexibility Offer AGR \u2192 DSO FlexOfferRevocation / FlexOfferRevocationResponse Exchange Flexibility Orders AGR \u2190 DSO FlexOrder / FlexOrderResponse <p>The use cases are explained in the following sections.</p>"},{"location":"use-case-descriptions/use-cases/operate-phase/#exchange-updated-d-prognoses","title":"Exchange updated D-Prognoses","text":"<p>The process diagram is similar to the figure in Exchange D-Prognoses per Congestion Point.</p> D-prognosis Goal in context Changes in D-prognoses to be realized are transmitted. Preconditions AGR has created initial D-prognoses in the Plan/Validate phases, and has subsequently detected deviations in Operate that resulted in a portfolio state that requires those prognoses to be re-created. Successful outcome Prognosis sent to DSO that reflects all relevant changes Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; D-prognosis failed to pass validation by the DSO Lacking ISPs The prognosis does not include all ISPs in the Period it applies to Power value rejection One or more Power values in the prognosis are not plausible Subordinate sequence number The message sequence is lower than that of a previously received D-prognosis [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/operate-phase/#related-information","title":"Related information","text":"<p>The process is similar to that described in Exchange D-Prognoses per Congestion Point. Deviations can be caused by new flexibility orders from the DSO and by unforeseen change of behavior by assets.</p> <p>The basic process for re-creating D-prognoses is the same as that used to create them in the first place, in the plan/validate phases. When re-creating prognoses in the operate phase, values for ISPs that are already in the past should remain unchanged, as these will be ignored by DSOs anyway.</p>"},{"location":"use-case-descriptions/use-cases/operate-phase/#revocation-flexibility-offer","title":"Revocation Flexibility Offer","text":"<p>The process diagram is similar to the figure in Revocation of FlexOffer.</p> Revoke FlexOffer Goal in context Inform the DSO that a previously sent flexibility offer is no longer valid, despite the validity period of the offer not having expired yet. Preconditions A flexibility offer has been sent to and acknowledged by the DSO Successful outcome Flexibility offer revocation notification submitted to the DSO Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexOfferRevocation failed to pass validation by the DSO Flexibility procured The FlexOffer cannot be revoked because its flexibility has already been ordered [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/operate-phase/#related-information_1","title":"Related information","text":"<p>The process is similar to that described in Revocation Flexibility Offer.</p> <p>Flexibility offers may be revoked in the operate phase provided that none of the ISPs in the period the offer applies to are already in, or past, the operate phase.</p>"},{"location":"use-case-descriptions/use-cases/operate-phase/#exchange-flexibility-orders","title":"Exchange Flexibility Orders","text":"<p>This process is triggered when flexibility is required to resolve congestion detected during the operate phase. This might, for example, be the case when the prognoses change after the validate phase and there are still FlexOffers available.</p> <p>The process diagram is similar to the figure in Exchange Flexibility Orders.</p> Revoke FlexOrder Goal in context Accept (some) flexibility offers to solve congestion during Operate phase. Preconditions Congestion detected while monitoring the grid, corresponding FlexOffer has been received and accepted by DSO and is still valid. Successful outcome Flexibility procured Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexOrder failed to pass validation by the AGR ISP mismatch ISPs from the FlexOrder do not match the ISPs given in the FlexOffer Power mismatch Ordered flexibility does not match the offered flexibility Price mismatch Price in the order does not match the price given in the offer [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/operate-phase/#related-information_2","title":"Related information","text":"<p>The process is similar to that described in Exchange Flexibility Orders. Note that where a FlexOrder is rejected, manual processing is unlikely to result in timely resolution at this stage. Note that although the updated D-prognosis is unlikely to be of immediate use to the DSO, it\u2019s definitely required for settlement.</p>"},{"location":"use-case-descriptions/use-cases/plan-phase/","title":"Plan phase","text":""},{"location":"use-case-descriptions/use-cases/plan-phase/#plan-phase","title":"Plan phase","text":"<p>In Plan phase the informative description of the plan phase processes are provided. In this chapter, use cases will be described as derived from the plan phase.</p> <p>The USEF MCM plan phase specifies the following use cases:</p> <p>Use cases for the Plan phase.</p> Name Direction Message types Retrieve Congestion Points AGR \u2192 CRO AGRPortfolioQuery / AGRPortfolioQueryResponse Retrieve Active Aggregators DSO \u2192 CRO DSOPortfolioQuery / DSOPortfolioQueryResponse Exchange Flexibility Reservation Update AGR \u2190 DSO FlexReservationUpdate / FlexReservationUpdateResponse <p>The use cases are explained in the following sections.</p> <p>If operating in open mode, the CRO will accept updates from any USEF-compliant participants implementing the AGR role. In closed mode, participants will need to be pre-configured in order for updates to be accepted.</p>"},{"location":"use-case-descriptions/use-cases/plan-phase/#retrieve-congestion-points","title":"Retrieve Congestion Points","text":"<p>The common reference allows an AGR to determine whether there are any congestion points where prosumers in its portfolio can offer flexibility.</p> <p> </p> Retrieval of Congestion Points corresponding to AGR's connections Publish Congestion Points / DSO Portfolio Goal in context Retrieve a list of all registered Connections represented by this AGR, grouped by Congestion Point, in order to enable flex trading with the responsible DSO. Preconditions The AGR has registered the Connection identifiers for which it represents Prosumers in the Common Reference. Successful outcome The AGR receives a list of Connections, grouped by Connection Point and responsible DSO, and a list of Connections that have not been allocated to a DSO. Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; AGRPortfolioQuery failed to pass validation by the CRO Unauthorized CRO is operating in closed mode and the AGR is not pre-registered as an authorized participant No connections available The AGR has no registered connections at the Common Reference [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/plan-phase/#related-information","title":"Related information","text":"<p>AGRs will only obtain DSO identities, congestion point identifiers and connection identifiers for those connections they have registered in the common reference themselves.</p> <p>Registered connections that have not (yet) been allocated by a DSO are returned in a separate list, to inform the AGR that there is no DSO available to trade with at those connections.</p>"},{"location":"use-case-descriptions/use-cases/plan-phase/#retrieve-active-aggregators","title":"Retrieve Active Aggregators","text":"<p>If operating in open mode, the CRO will accept queries from any USEF-compliant participants implementing the AGR role. In closed mode, participants will need to be pre-configured in order for updates to be accepted.</p> <p> </p> Retrieval of registered Connections, grouped by Congestion Point, including corresponding AGR identity Publish Congestion Points / DSO Portfolio Goal in context Retrieve a list of all DSO-registered Congestion Points with, for each such point, a list of AGRs representing Prosumers there, including the number of Connections each AGR represents.The DSO then knows from which AGRs D-prognoses can be expected, and which percentage of the total Connections on each Congestion Point is affected by those prognoses. Preconditions The DSO has determined its Congestion Points and published this information, including the associated Connection identifiers in the Common Reference.The AGR has registered the Connection identifiers for which it represents Prosumers in the Common Reference (see UC1027) Successful outcome AGRs which represent Prosumers at any of the Congestion Points registered by the DSO are available to the DSO Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; DSOPortfolioQuery failed to pass validation by the CRO Unauthorized CRO is operating in closed mode and the AGR is not pre-registered as an authorized participant No connections available The DSO has no registered connections at the Common Reference [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/plan-phase/#related-information_1","title":"Related information","text":"<p>DSOs may only obtain AGR identities and combined connection counts for those congestion points they have registered in the common reference themselves.</p>"},{"location":"use-case-descriptions/use-cases/plan-phase/#exchange-flexibility-reservation-update","title":"Exchange Flexibility Reservation Update","text":"<p>Where bilateral contracts are used, the FlexReservationUpdate message can be used at this stage to set or release reserved flexibility.</p> <p> </p> Exchange of FlexReservationUpdate Publish Congestion Points / DSO Portfolio Goal in context For all reserved power in a bilateral contract, the DSO signals which part of the contracted volume is still reserved and which part is not needed and may be used for other purposes. Preconditions The DSO and AGR have agreed on a bilateral contract (out of scope for UFTP) which the FlexReservationUpdate refers to. Successful outcome The AGR has received the update and can potentially reoptimize its portfolio based on the changes. The DSO registers the update for settlement purposes. Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexReservationUpdate failed to pass validation by the AGR Deadline expired The deadline for the DSO to release reserved flexibility has expired Power value rejection One or more Power values in the FlexReservationUpdate are not conform agreement [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/settle-phase/","title":"Settle phase","text":""},{"location":"use-case-descriptions/use-cases/settle-phase/#settle-phase","title":"Settle phase","text":"<p>The informative description of the settle phase processes are provided in Settle phase. In this chapter, the use cases will be described, as derived from the settle phase.</p> <p>The USEF MCM settle phase specifies the following use case:</p> <p>Use cases for the settle phase.</p> Name Direction Message types Process Settlement Items AGR \u2190 DSO FlexSettlement/ FlexSettlementResponse"},{"location":"use-case-descriptions/use-cases/settle-phase/#process-settlement-items","title":"Process Settlement Items","text":"Transmission of settlement including acceptance process per settlement item Revoke FlexOrder Goal in context DSO sends consolidated settlement volumes and prices to the AGR for a specific period. AGR verifies the settlement calculations performed by DSO: acknowledge settlement items that are plausible according to the AGR or start a dispute process if they show disputable results. AGR returns the list of verified settlement items. Preconditions All settlement items within the period are available and complete Successful outcome Periodic settlement invoice sent by DSO, validated by AGR and a potential dispute process is started. Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexSettlement failed to pass validation by the AGR Missing Settlement Items Not all flexibility that have been procured within the given period is included as a settlement item. PeriodStart rejected The settlement period starts too late (for example in case there are unsettled items from an earlier period) or is not plausible (for example in case it starts in the future). PeriodEnd rejected The settlement period ends too early (for example in case there are unsettled items from a later period that have to be treated too) or is not plausible (for example in case it is earlier than the PeriodStart or in the future). [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/settle-phase/#related-information","title":"Related information","text":"<p>If settlement items are missing, the message should be rejected (as mentioned in failure outcome). This is to encourage sending of all required information necessary to settle trades as soon as possible, thereby avoiding a series of unsettled trades for a given period.</p> <p>Note that the rejection of a FlexSettlement message is not a means of raising a dispute for settlement items. The dispute process is out-of-scope for USEF.</p>"},{"location":"use-case-descriptions/use-cases/validate-phase/","title":"Validate phase","text":""},{"location":"use-case-descriptions/use-cases/validate-phase/#validate-phase","title":"Validate phase","text":"<p>In Validate phase, informative description of the validate phase processes has been given. In this chapter the use cases will be described as derived from the validate phase.</p> <p>The USEF MCM validate phase specifies the following use cases:</p> <p>Use cases for the Validate phase.</p> Name Direction Message types Exchange D-Prognoses per Congestion Point AGR \u2192 DSO Prognosis / PrognosisResponse Exchange Flexibility Requests AGR \u2190 DSO FlexRequest / FlexRequestResponse Exchange Flexibility Offers AGR \u2192 DSO FlexOffer / FlexOfferResponse Revocation Flexibility Offer AGR \u2192 DSO FlexOfferRevocation / FlexOfferRevocationResponse Exchange Flexibility Orders AGR \u2190 DSO FlexOrder / FlexOrderResponse <p>The use cases are explained in the following sections.</p>"},{"location":"use-case-descriptions/use-cases/validate-phase/#exchange-d-prognoses-per-congestion-point","title":"Exchange D-Prognoses per Congestion Point","text":"Exchange of D-prognoses D-prognosis Goal in context D-prognoses are (re)created by the AGR per congestion point, based on its portfolio. These D-prognoses will be submitted to the DSO. D-prognoses should be submitted at least once before the gate closure time. D-prognoses can be updated by transmitting a new one. Preconditions Congestion point(s) defined and retrieved from the CRO, AGR per congestion point retrieved from CRO by DSO, AGR-DSO contracts in place. Successful outcome D-prognosis message created and accepted by the DSO for each congestion point on which the AGR has active Connections Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; D-prognosis failed to pass validation by the DSO Lacking ISPs The prognosis does not include all ISPs in the Period it applies to Power value rejection One or more Power values in the prognosis are not plausible Subordinate sequence number The message sequence is lower than that of a previously received D-prognosis [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/validate-phase/#related-information","title":"Related information","text":"<p>Congestion points (with associated DSOs) at which the AGR has contracted prosumers, and active AGRs, are available via the common reference and should have been retrieved prior to executing this use case.</p> <p>It is essential to use a sequence number that is incremented each time a new revision is sent so the order of transmission can be traced.</p>"},{"location":"use-case-descriptions/use-cases/validate-phase/#exchange-flexibility-requests","title":"Exchange Flexibility Requests","text":"Exchange of FlexRequests FlexRequest Goal in context If grid congestion is expected, requests for flexibility are created by the DSO and sent to AGRs potentially capable of helping to reduce that congestion. These requests serve as the basis for subsequent flexibility offers. Preconditions AGR-DSO market contract in place.One or more Congestion Points registered in the Common Reference, with at least one AGR with contracted Connections on that point.DSO grid safety analysis performed. Successful outcome Flexibility requests submitted to AGR(s) Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexRequest failed to pass validation by the AGR Lacking Requested Disposition The FlexRequest has no ISP with a \u201crequested\u201d disposition. Requested Power discrepancy One or more ISPs with a \"requested\" disposition has no direction: MinPower &lt; 0 and MaxPower &gt; 0. Power discrepancy One or more ISPs has a higher MinPower than MaxPower value. [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/validate-phase/#related-information_1","title":"Related information","text":"<p>Each flexibility request should include the ISPs for which congestion is expected, including a direction (MinPower \u2265 0 or MaxPower \u2264 0), and it is advisable to send multiple ISPs for which capacity is still available, to allow AGRs to time-shift load. For each period during which congestion is expected, the DSO may create any number of flexibility requests (including no requests at all). If multiple requests are created, their content must not be identical. Which variations (more/less requested power per ISP, time-shift of load) are created is a DSO-internal business decision.</p>"},{"location":"use-case-descriptions/use-cases/validate-phase/#exchange-flexibility-offers","title":"Exchange Flexibility Offers","text":"Exchange of FlexOffers FlexOffer Goal in context The AGR creates flexibility offers based on previous DSO flexibility requests and sends these to the originating DSOs. It is also possible to send FlexOffers that do not originate from a FlexRequest, which are called unsolicited FlexOffers. Each offer indicates to which extent the AGR can provide flexibility, what the effect on its baseline will be and what the price for the flexibility would be. Preconditions AGR-DSO market contract in place.AGR has at least one contracted Connection on the Congestion point. Flexibility offers can be based on previous flexibility requests that have been accepted and stored, or be initiated without a preliminary flex request (called an unsolicited flex offer). Successful outcome Flexibility offers sent to the DSO Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexOffer failed to pass validation by the DSO No baseline The AGR has no valid baseline, possibly lacking a valid D-prognosis Power value rejection One or more Power values in the FlexOffer are not plausible Request mismatch None of the ISPs with a \"requested\" disposition in the referred FlexRequest, is mentioned in the FlexOffer No MutEx offer support The FlexOffer contains mutual exclusive offers (OfferOptions), which is not supported by the DSO [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/validate-phase/#related-information_2","title":"Related information","text":"<ul> <li>USEF does not specify how the AGR determines the optimal flexibility offer, offer price or optimal timing to send the offer to the DSO.</li> <li>AGRs may choose to send multiple FlexOffer messages: this includes sending a FlexOffer that better meets the DSO request at a much later time when circumstances have changed. Unsolicited FlexOffers are also allowed, in which case the FlexRequestOrigin and FlexRequestSequence fields are empty.</li> <li>Sending a FlexOffer for partial activation is always allowed, although it is ignored by the DSO if it does not support partial activation (in which case the MinActivationFactor is always 1).</li> </ul> <p>Note that acceptance of the FlexOffer message does not imply ordering of the flexibility.</p>"},{"location":"use-case-descriptions/use-cases/validate-phase/#revocation-flexibility-offer","title":"Revocation Flexibility Offer","text":"Revocation of FlexOffer Revoke FlexOffer Goal in context When a previously sent flexibility offer is no longer valid, despite the validity period of the offer not having expired yet, the AGR informs the DSO that the offer is revoked. After revocation, the DSO cannot order the flexibility from this offer anymore. Preconditions The concerning flexibility offer has been sent to and acknowledged by the DSO, and has not (yet) been procured using a FlexOrder Successful outcome Flexibility offer revocation notification submitted to the DSO Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexOfferRevocation failed to pass validation by the DSO Flexibility procured The FlexOffer cannot be revoked because its flexibility has already been ordered [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/validate-phase/#related-information_3","title":"Related information","text":"<p>Only flexibility offers communicated using a FlexOffer message which has already been acknowledged by the DSO can be revoked. If the acknowledgement is still pending, the AGR should delay sending its FlexOfferRevocation message until the acknowledgement has been received. When the DSO receives a revocation of a flexibility offer it wants to order, this is not a valid base to reject the revocation. After revocation, the offer can no longer be ordered.</p> <p>FlexOffers may be revoked at any time in the plan and validate phases (and also in operate phase as described in Revocation Flexibility Offer), unless there is already a FlexOrder based on the offer. Notice that FlexOrders and FlexOfferRevocations can cross each other. Where this is the case, priority should be given to the FlexOfferRevocation.</p>"},{"location":"use-case-descriptions/use-cases/validate-phase/#exchange-flexibility-orders","title":"Exchange Flexibility Orders","text":"Exchange of FlexOrder FlexOrder Goal in context Process for the DSO to accept (some) flexibility offers to solve Congestion based on the Prognosis. Preconditions Corresponding FlexOffer has been received and accepted by DSO and is still valid. Successful outcome Flexibility procured Failure outcome RejectionReason Cause of rejection &lt;See Message validation&gt; FlexOrder failed to pass validation by the AGR ISP mismatch ISPs from the FlexOrder do not match the ISPs given in the FlexOffer Power mismatch Ordered flexibility does not match the offered flexibility Price mismatch Price in the order does not match the price given in the offer [User defined] Any other reasonable cause to reject the message"},{"location":"use-case-descriptions/use-cases/validate-phase/#related-information_4","title":"Related information","text":"<p>The DSO needs to make its own decisions about which FlexOffers to accept. FlexOffers can only be ordered once and have to be ordered as specified in the corresponding offer for the specified price. Only in situations where partial activation is supported and offered in the FlexOffer can the ISP power and price be altered to conform to the specifications from Section Flexibility trading between the AGR and DSO. After a successful FlexOrder transmission, the AGR is responsible for providing the ordered flexibility via an updated D-prognosis which reflects the traded flexibility.</p>"}]}